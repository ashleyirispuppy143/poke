 <!--
    This Source Code Form is subject to the terms of the GNU General Public License:
   
    Copyright (C) 2021-2026 PokeTube Of Poke Project, a part of The Poke Project Initiative (initiative.poketube.fun) 
    source code :https://codeberg.org/ashley/poke

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program. If not, see https://www.gnu.org/licenses/.
-->
<!DOCTYPE html>
<head>
<title>Searching <%=q%> | Poke</title>
<link rel="manifest" href="/manifest.json">
<link href="/css/yt-ukraine.svg?v=8" rel=icon>
<link href="/css/app-cdn.min.css" rel=stylesheet>
<link href="/css/app.main.css?v=44600" rel=stylesheet>
<link href="/css/search.main.css?v=547" rel=stylesheet>
<link href="/css/watch.main.css" rel=stylesheet>
<meta name="darkreader-lock"> <!-- tells dark reader that the site has a dark theme and to turn itself off -->

<!-- Open Graph -->
<meta content="Searching <%=q%> | Poke" property="og:title">
<% if (q == "do the harlem shake") { %>
  <meta content="DO THE HARLEM SHAKE" property="og:description">
<% } else { %>
  <meta content="Ur Searching <%=q%> on Poke!" property="og:description">
<% } %>
  <meta property="og:image" content="/static/poke.webp">
<meta property="og:type" content="website">

<!-- Twitter -->
<meta content="Searching <%=q%> | Poke" name="twitter:title">
<% if (q == "do the harlem shake") { %>
  <meta content="DO THE HARLEM SHAKE" name="twitter:description">
<% } else { %>
  <meta content="Ur Searching <%=q%> on Poke!" name="twitter:description">
<% } %>
  <meta property="og:image" content="/static/poke.webp">
<meta content="summary_large_image" name="twitter:card">

<!-- Facebook -->
<meta property="facebook:title" content="Searching <%=q%> | Poke">
<% if (q == "do the harlem shake") { %>
  <meta property="facebook:description" content="DO THE HARLEM SHAKE">
<% } else { %>
  <meta property="facebook:description" content="Ur Searching <%=q%> on Poke!">
<% } %>
  <meta property="og:image" content="/static/poke.webp">
<meta content="#1a1a1a" name="theme-color">

<style>
   a.class:hover {
    text-decoration:underline;
    font-weight:bold
}
  summary{
    color:blue;
}
summary:hover{
    color:red;
}
  * {
    color:#fff;
   }
      nav {
        background:#111111
    }
  
  
 
</style>    

<style>
.new-button {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  height: 2em;
  padding: 0 0.6rem;
  border-radius: 1.5em;
  position: relative;
  color: #fff;
  font: 500 14px/1 sans-serif;
  text-decoration: none;

  background: rgba(51, 51, 51, 0.05);
  backdrop-filter: blur(48px) saturate(200%);
  -webkit-backdrop-filter: blur(48px) saturate(200%);

  border: 1px solid rgba(255,255,255,0.22);

  transition: transform 120ms ease, background 120ms ease;
}

.new-button::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  background:
    radial-gradient(140% 100% at 12% -30%, rgba(255,255,255,0.55) 0%, rgba(255,255,255,0.14) 30%, rgba(255,255,255,0) 60%),
    linear-gradient(180deg, rgba(255,255,255,0.10), rgba(255,255,255,0));
  mix-blend-mode: screen;
}

.new-button:hover {
  transform: translateY(-1px);
  background: rgba(51, 51, 51, 0.08);
}

.new-button:active {
  transform: translateY(0);
  opacity: 0.90;
}

.new-button .icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 1.2em;
  height: 1.2em;
  border-radius: 50%;
}

.new-button .icon i {
  font-size: 1em;
  color: #fff;
}

.new-button[href*="youtube"] .icon i {
  color: #ff2a2a;
}

@supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))) {
  .new-button {
    background: rgba(51, 51, 51, 0.6);
  }
}
</style>
  <link href=https://p.poketube.fun/https://site-assets.fontawesome.com/releases/v6.1.1/css/all.css rel=stylesheet>
  <link href="https://p.poketube.fun/https://cdn.jsdelivr.net/npm/ionicons@4.5.0-0/dist/css/ionicons.min.css" rel=stylesheet>

  <style>
    
    @font-face {
  font-family: "PokeTube Flex";
  src: url("/static/robotoflex.ttf");
  font-style: normal;
  font-stretch: 1% 800%;
  font-display: swap;
}

.search-options {
  display: flex;
  justify-content: space-between;
  width: 100%;
  max-width: 855px;
  margin: auto;
  padding: 24px 0px 12px 0px; 
}
    
.tags.rec:hover{
  overflow-x:auto;
}
.tags.rec {
  display: flex;
  gap: 12px;
  height: max-content;
}
.tags.rec > .tag {
  border-radius: 8px;
  background: var(--chip-background-hover);
  padding: 8px 16px;
}

.tag {
  padding: 5px;
  border-radius: 4px;
  word-break: break-all;
  white-space: nowrap;
  font-family: ubuntu, sans-serif;
} 

#filters-collapse summary {
  color: white;
  font-weight: bold;
  font-size: 20px;
}
.filter-options div {
  padding: 6px 12px;
}
.filter-name.underlined {
  padding: 12px 0px 12px 23px;
  font-weight: bold;
}
    
.container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: #333;
      border: 1px solid #ccc;
      border-radius: 5px;
      text-align:center;
    }
    .container > * {
            text-align:center !important;

    }
    .info > div {
      font-family:Ubuntu, sans-serif;
    }
       #fetch-spinner {
  position: fixed;
  top: 10px;
  right: 10px;
 z-index: 9999; 
  width: 20px;
  height: 20px;
  border-radius: 50%;
  border-top: 2px solid #fff;
  border-right: 2px solid #fff;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

#fetch-text {
  position: fixed;
  top: 10px;
  right: 40px;
  color: #fff;
  font-weight: bold;
  text-transform: uppercase;
   z-index: 9999; 

}

.hide {
  display: none;
}

   .app{
    /* background-image:url("/css/head.svg"); */
    background-size: cover;
  background-repeat: no-repeat;
   }
      .shake  {
  animation: linear infinite alternate;
  animation-name: DOTHESHAKE;
  animation-duration: 1.5s;
}

@-webkit-keyframes DOTHESHAKE {
    0% {
      left: 0;
      transform: translateX(0);
    }
    100% {
      left: 900%;
      transform: translateX(-90%);
    }
}
         
   /* nice classname am i rigth */
   .discover-some-bitches{
     text-align: center;
     width: 673px;
     margin: auto;
   }
    
    .shelf {
          max-width: 51em;
  margin: auto;
  display: flex;
  flex-direction: column;
  row-gap: 16px;
  padding: 16px;
background: #111111;
border: #333333 solid;
border-radius: 19px;
margin-top: 1em;
    }
    
        @font-face {
        font-family: 'Ginto Nord';
        font-weight: 800;
        src:url('https://p.poketube.fun/https://cdn.statically.io/gh/brecert/discord-quote-generator/main/Ginto-Nord-800.woff') format("woff");
      }
    
.video-list > .video {
  background: #111;
  padding: 10px;
  border-radius: 10px;
  border: #333 solid;
}
  </style>
                 <style>section p {
 font-family:Whitney, Helvetica Neue, Helvetica, Arial, sans-serif;
 font-weight:400;
 color:#fff;
 font-size:16px;
 line-height:24px;
 margin-top:12px
}
                   
                   .wiki > p {
  margin-top: -2em;
}
                   * {
text-rendering: auto;
                   }
    
.sticky-top {
	 position: sticky;
	 top: 0px;
	 z-index: 999;
}
 .responsive {
	 width: 100%;
	 overflow-x: auto;
}
 .tabs {
	 display: table;
   font-family:inter;
	 border-collapse: separate;
	 table-layout: auto;
}
.video:hover{
border:solid;
}                  
 .tabs {
	 display: table;
   font-family:inter;
	 border-collapse: separate;
	 table-layout: auto;
}
 .tabs.tabs-center {
	 margin: auto;
}
 .tabs.tabs-justify {
	 width: 100%;
	 table-layout: fixed;
}
 .tabs a.tab {
	 position: relative;
	 display: table-cell;
	 transition: all ease 0.3s;
	 padding: 1em 1.6em;
	 transform: translate3d(0, 0, 0);
	 color: #fff;
	 white-space: nowrap;
	 cursor: pointer;
}
 .tabs a.tab:hover {
	 color: #3cb4fa;
}
 .tabs a.tab:after {
	 transition: all 0.3s cubic-bezier(1, 0, 0, 1);
	 will-change: transform, box-shadow, opacity;
	 position: absolute;
	 content: '';
	 height: 3px;
	 bottom: 0px;
	 left: 0px;
	 right: 0px;
	 border-radius: 3px 3px 0px 0px;
	 background: #9fdafd;
	 box-shadow: 0px 4px 10px 3px rgba(60, 180, 250, .15);
	 opacity: 0;
	 transform: scale(0, 1);
}
 .tabs a.tab.active {
	 color: #fff;
}
 .tabs a.tab.active:after {
	 opacity: 1;
	 transform: scale(1, 1);
}                 
       
.something-background-a {
    background-image: url('<%- media_proxy_url %>/proxy?url=https://static.wikia.nocookie.net/omori/images/f/fc/Something_Bed_(2018_Demo).gif') !important;
}
.something-background-b {
    background-image: url('<%- media_proxy_url %>/proxy?url=https://static.wikia.nocookie.net/omori/images/1/14/Hangman_%28Laptop%29.png') !important;
}
.something-background-c {
    background-image: url('<%- media_proxy_url %>/proxy?url=https://static.wikia.nocookie.net/omori/images/6/67/Nanci_Before.png') !important;
}

.loading .spinner {
  display: inline-block;
  border: 5px solid rgba(255, 255, 255, 0.2);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 1s ease-in-out infinite;
  width: 50px;
  height: 50px;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

                   .a {
                     display:none;
                   }
                     </style>
 </head>
     
                 <% if(IsOldWindows) { %>
              <style>
                .title.max-lines-2 {
                  font-family:"Inter " !important;
                }
              </style>
              
                                                      		 	               <% } %>   


  <body>
  
 
        <div class="app">
   
    <nav>
             <div class=left>

  <% if (q == "do the harlem shake") { %>  
              <a class="shake" href="/143" style=font-family:Inter,sans-serif;color:#fff>  <img style="transform: scale(1.3);width:8.5em;display: block;margin-left: auto;margin-right: auto;" src="/css/logo.svg?v=5"></a>
               <audio class="player" autoplay loop controls src="https://woke-proxy.poketube.fun/companion/latest_version?id=8vJiSSAMNWw&itag=140&local=true?e=ca0ac04022e782540e1f2fe4d6c2994949f33184ccc07568b4b1d7c93dfebd28119cb7b9e8b5db12039ba553ed861736ca0ac04022e782540e1f2fe4d6c2994949f33184ccc07568b4b1d7c93dfebd28119cb7b9e8b5db12039ba553ed861736Piwikd74c7f459daf669799074a22bcf7d79bb66e03dbd9899a2089e0bee8ed383f0c3b928c4477a42208cbd69a77549e3451
" style="display:none;"> 
        <script>
             // @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&dn=gpl-3.0.txt GPL-3.0-or-later
                   setTimeout(function () {
                      const video = document.getElementsByClassName("video")
                      for(var counter = 0; counter < video.length; counter++){
video[counter].classList.add("shake");
}
                   }, 13700)
               // @license-end
                                     </script>
   <% } %> 

  <% if (q == "do a barrel roll") { %>  
          <style>
    @keyframes barrelRoll {
      to {
        transform: rotate(360deg);
      }
    }

    body {
      animation: barrelRoll 2s alternate; 
    }
  </style>
   
   <% } %> 
     
     <% if (q != "do the harlem shake") { %>   <% if (q != "want you gone") { %>  <% if (q != "portal 2 ending") { %>   <% if (q != "credits") { %>  <% if (q != "glados") { %>  <% if (q != "something") { %>  

              <a class="class" href="/143" style=font-family:Inter,sans-serif;color:#fff>  <img style="transform: scale(1.3);width:8.5em;display: block;margin-left: auto;margin-right: auto;" src="/css/logo.svg?v=5"></a>
       
       
       
     
   <% } %> 
        <% } %><% } %>     


   <% } %> 
   <% } %> 

        <% if (q == "want you gone" || q == "portal 2 ending" ||  q == "credits" || q == "glados ") { %>  
            
              <a class="class" href="/credits" style=font-family:Inter,sans-serif;color:#fff>  <img style="transform: scale(1.3);width:8.5em;display: block;margin-left: auto;margin-right: auto;" src="/css/logo-orng.svg?v=5"></a>
          
   <% } %> 
     
     
          <% if (q == "something") { %>  
              <a class="class" href="/143?something=143" style=font-family:Inter,sans-serif;color:#fff>  <img style="transform: scale(1.3);width:8.5em;display: block;margin-left: auto;margin-right: auto;" src="/css/logo.svg?v=5"></a>

                    <% } %> 

        <% } %> 

     
     
            </div>          

  
        <div class="middle">
<div class="search">
  
        <form action=/search><input class=search-bar autocomplete="on"  value="<%=q%>" id=fname name=query  style="color:#fff;font-family:Inter,sans-serif;border-radius: 8px;background: linear-gradient(90deg, hsla(235, 21%, 21%, 1) 0%, hsla(194, 41%, 22%, 1) 50%, hsla(174, 48%, 20%, 1) 100%);" >
          <button class="btn btn-success" type=submit><i class="fa-light fa-search"></i></button>
             
         </form>

      </div>          </div>


            <div class=right style="background: #333;
  border-radius: 2em;
  height: 49px;
  margin-top: 5px;">
              
<button title="Play/Pause Ambient music" class="a" id="audioButton" onclick="toggleAudio()">
  <i id="audioIcon" class="fas fa-pause"></i>
</button>

              <a href="/domains"><i  style="display: block;margin-left: auto;margin-right: auto;" class="fa-light fa-server"></i>  </a>
              <a href="/privacy"><i class="fa-light fa-shield"></i></a>
              <a href="/video/upload?from="><i class="fa-light fa-video"></i></a> 
              <a href="https://codeberg.org/Ashley/poketube/issues"><i class="fa-light fa-bug"></i></a>
            </div>
     
      </nav>
  
  
   </div>
      

    
       </div>
  <div class="channel-page"   style="background-color: var(--channel-contents-background);">   
    <div class="search-options">
    <div id="filters" style="
  --bg-primary: #181818; 
  --bg-secondary: #212121; 
  --border-color: #3d3d3d; 
  --text-primary: #f1f1f1; 
  --text-secondary: #aaaaaa; 
  --accent-color: #3ea6ff; 
  font-family: system-ui, -apple-system, sans-serif; 
  color: var(--text-primary); 
  max-width: 900px; 
  margin: 0 auto;
">
  <details id="filters-collapse" style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 8px; overflow: hidden;width: fit-content;margin-left: -24em;">
    <summary style="padding: 12px 16px; cursor: pointer; font-weight: 500; background: var(--bg-secondary); border-bottom: 1px solid var(--border-color); user-select: none; display: flex; gap: 8px; align-items: center;">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg>
      Filters
    </summary>
    
    <div id="filters-box" style="padding: 20px;">
      <form action="/search" method="get" style="margin: 0;">
        <input type="hidden" name="query" value="<%- q %>">
        <input type="hidden" name="continuation" value="<%- continuation %>">
        
        <div id="filters-flex" style="display: flex; flex-wrap: wrap; gap: 32px;">
          
          <div class="filter-column" style="flex: 1; min-width: 180px;">
            <fieldset style="border: none; padding: 0; margin: 0;">
              <legend style="padding: 0; margin-bottom: 16px; width: 100%;">
                <div class="filter-name" style="font-weight: 600; font-size: 0.85em; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid var(--border-color); padding-bottom: 8px;">Upload date</div>
              </legend>
              <div class="filter-options" style="display: flex; flex-direction: column; gap: 12px;">
                <% const selectedDate = date || "none"; %>
                <% ['none', 'hour', 'today', 'week', 'month', 'year'].forEach(option => { %>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <input type="radio" name="date" id="filter-date-<%= option %>" value="<%= option %>" <%= selectedDate === option ? 'checked' : '' %> style="margin: 0; width: 16px; height: 16px; accent-color: var(--accent-color); cursor: pointer;">
                    <label for="filter-date-<%= option %>" style="cursor: pointer; font-size: 0.95em; color: <%= selectedDate === option ? 'var(--text-primary)' : 'var(--text-secondary)' %>;">
                      <%= option === 'none' ? 'Any date' : option === 'hour' ? 'Last Hour' : option === 'today' ? 'Today' : option === 'week' ? 'This week' : option === 'month' ? 'This month' : 'This year' %>
                    </label>
                  </div>
                <% }) %>
              </div>
            </fieldset>
          </div>

          <div class="filter-column" style="flex: 1; min-width: 180px;">
            <fieldset style="border: none; padding: 0; margin: 0;">
              <legend style="padding: 0; margin-bottom: 16px; width: 100%;">
                <div class="filter-name" style="font-weight: 600; font-size: 0.85em; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid var(--border-color); padding-bottom: 8px;">Duration</div>
              </legend>
              <div class="filter-options" style="display: flex; flex-direction: column; gap: 12px;">
                <% const selectedDuration = duration || "none"; %>
                <% ['none', 'short', 'long', 'medium'].forEach(option => { %>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <input type="radio" name="duration" id="filter-duration-<%= option %>" value="<%= option %>" <%= selectedDuration === option ? 'checked' : '' %> style="margin: 0; width: 16px; height: 16px; accent-color: var(--accent-color); cursor: pointer;">
                    <label for="filter-duration-<%= option %>" style="cursor: pointer; font-size: 0.95em; color: <%= selectedDuration === option ? 'var(--text-primary)' : 'var(--text-secondary)' %>;">
                      <%= option === 'none' ? 'Any duration' : option === 'short' ? 'Short (< 4 minutes)' : option === 'long' ? 'Long (> 20 minutes)' : 'Medium (4 - 20 minutes)' %>
                    </label>
                  </div>
                <% }) %>
              </div>
            </fieldset>
          </div>

          <div class="filter-column" style="flex: 1; min-width: 180px;">
            <fieldset style="border: none; padding: 0; margin: 0;">
              <legend style="padding: 0; margin-bottom: 16px; width: 100%;">
                <div class="filter-name" style="font-weight: 600; font-size: 0.85em; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid var(--border-color); padding-bottom: 8px;">Sort By</div>
              </legend>
              <div class="filter-options" style="display: flex; flex-direction: column; gap: 12px;">
                <% const selectedSort = sort || "relevance"; %>
                <% ['relevance', 'rating', 'views'].forEach(option => { %>
                  <div style="display: flex; align-items: center; gap: 10px;">
                    <input type="radio" name="sort" id="filter-sort-<%= option %>" value="<%= option %>" <%= selectedSort === option ? 'checked' : '' %> style="margin: 0; width: 16px; height: 16px; accent-color: var(--accent-color); cursor: pointer;">
                    <label for="filter-sort-<%= option %>" style="cursor: pointer; font-size: 0.95em; color: <%= selectedSort === option ? 'var(--text-primary)' : 'var(--text-secondary)' %>;">
                      <%= option === 'relevance' ? 'Relevance' : option === 'rating' ? 'Rating' : 'View count' %>
                    </label>
                  </div>
                <% }) %>
              </div>
            </fieldset>
          </div>

        </div>

        <div id="filters-apply" style="margin-top: 24px; display: flex; justify-content: flex-end; border-top: 1px solid var(--border-color); padding-top: 16px;">
          <button type="submit" style="background: var(--text-primary); color: var(--bg-primary); padding: 8px 24px; border-radius: 24px; border: none; font-weight: 600; font-size: 0.95em; cursor: pointer; transition: opacity 0.2s;">
            Apply Filters
          </button>
        </div>

      </form>
    </div>
  </details>
</div>
    <div class="tags rec">
                  
                                <a style=" background: #111;" class="tag">
Videos
                   </a>
                  
                      <a href="/web?query=<%=q%>" style="color:#fff;text-decoration:none;display:none;
" class="tag c"> 
Web              </a>
                  
                     </div>   
          </div>
  <%
const query = (q || '').toLowerCase().trim();
let answer = '';

function isMathExpression(s) {
    return /^[0-9\s+\-*/.x]+$/.test(s);
}

function evaluateMathExpression(src) {
    const expr = src.replace(/\s+/g, '');
    if (expr === '9+10') return '21';
    try {
        // Safer than eval: no access to local scope; still only for simple arithmetic
        const val = Function('"use strict";return (' + expr + ')')();
        return String(val);
    } catch {
        return 'Invalid Expression';
    }
}

function getCurrentDate() {
    const now = new Date();
    return now.toLocaleDateString();
}

function getCurrentYear() {
    return String(new Date().getFullYear());
}

function getTimeInTimezone(location) {
   const tzMap = {
  // USA (states & major cities)
  "california":"America/Los_Angeles","los angeles":"America/Los_Angeles","la":"America/Los_Angeles","san diego":"America/Los_Angeles","santa monica":"America/Los_Angeles","san francisco":"America/Los_Angeles","oakland":"America/Los_Angeles","san jose":"America/Los_Angeles","sacramento":"America/Los_Angeles",
  "seattle":"America/Los_Angeles","portland":"America/Los_Angeles","las vegas":"America/Los_Angeles","reno":"America/Los_Angeles","boise":"America/Boise","spokane":"America/Los_Angeles",
  "arizona":"America/Phoenix","phoenix":"America/Phoenix","tucson":"America/Phoenix","mesa":"America/Phoenix","scottsdale":"America/Phoenix",
  "denver":"America/Denver","colorado springs":"America/Denver","salt lake city":"America/Denver","albuquerque":"America/Denver","santa fe":"America/Denver","cheyenne":"America/Denver",
  "chicago":"America/Chicago","minneapolis":"America/Chicago","saint paul":"America/Chicago","st paul":"America/Chicago","milwaukee":"America/Chicago","madison":"America/Chicago","des moines":"America/Chicago","kansas city":"America/Chicago","st louis":"America/Chicago","saint louis":"America/Chicago","memphis":"America/Chicago","nashville":"America/Chicago","birmingham al":"America/Chicago","houston":"America/Chicago","dallas":"America/Chicago","austin":"America/Chicago","san antonio":"America/Chicago","oklahoma city":"America/Chicago","tulsa":"America/Chicago","new orleans":"America/Chicago","baton rouge":"America/Chicago","little rock":"America/Chicago","fargo":"America/Chicago","lincoln ne":"America/Chicago","omaha":"America/Chicago",
  "new york":"America/New_York","nyc":"America/New_York","manhattan":"America/New_York","brooklyn":"America/New_York","queens":"America/New_York","the bronx":"America/New_York","staten island":"America/New_York","buffalo":"America/New_York","rochester ny":"America/New_York","albany ny":"America/New_York",
  "boston":"America/New_York","cambridge ma":"America/New_York","providence":"America/New_York","hartford":"America/New_York","new haven":"America/New_York",
  "philadelphia":"America/New_York","pittsburgh":"America/New_York","baltimore":"America/New_York","washington dc":"America/New_York","dc":"America/New_York","arlington va":"America/New_York","richmond va":"America/New_York","charlotte":"America/New_York","raleigh":"America/New_York","durham":"America/New_York","charleston sc":"America/New_York","atlanta":"America/New_York","savannah":"America/New_York","miami":"America/New_York","orlando":"America/New_York","tampa":"America/New_York","jacksonville":"America/New_York",
  "detroit":"America/Detroit","cleveland":"America/New_York","columbus oh":"America/New_York","cincinnati":"America/New_York","indianapolis":"America/Indiana/Indianapolis","louisville":"America/Kentucky/Louisville",
  "anchorage":"America/Anchorage","fairbanks":"America/Anchorage","juneau":"America/Juneau",
  "honolulu":"Pacific/Honolulu","hilo":"Pacific/Honolulu","kahului":"Pacific/Honolulu","lihue":"Pacific/Honolulu",  "toronto":"America/Toronto","mississauga":"America/Toronto","ottawa":"America/Toronto","kingston on":"America/Toronto","london on":"America/Toronto",
  "montreal":"America/Toronto","bagotville":"America/Montreal","quebec city":"America/Toronto","sherbrooke":"America/Toronto",
  "vancouver":"America/Vancouver","victoria bc":"America/Vancouver","kelowna":"America/Vancouver","prince george":"America/Vancouver",
  "calgary":"America/Edmonton","edmonton":"America/Edmonton","winnipeg":"America/Winnipeg","regina":"America/Regina","saskatoon":"America/Regina",
  "st johns":"America/St_Johns","halifax":"America/Halifax","moncton":"America/Moncton","fredericton":"America/Halifax","charlottetown":"America/Halifax",
  "mexico city":"America/Mexico_City","guadalajara":"America/Mexico_City","monterrey":"America/Monterrey","tijuana":"America/Tijuana","hermosillo":"America/Hermosillo","culiacan":"America/Mazatlan","mazatlan":"America/Mazatlan","chihuahua":"America/Chihuahua","merida":"America/Merida","cancun":"America/Cancun","quetzaltenango":"America/Guatemala",
  "guatemala city":"America/Guatemala","belmopan":"America/Belize","belize city":"America/Belize","san salvador":"America/El_Salvador","tegucigalpa":"America/Tegucigalpa","managua":"America/Managua","san jose cr":"America/Costa_Rica","panama city":"America/Panama",

  // South America & Caribbean
  "bogota":"America/Bogota","medellin":"America/Bogota","cali":"America/Bogota",
  "lima":"America/Lima","quito":"America/Quito","guayaquil":"America/Guayaquil",
  "caracas":"America/Caracas","maracaibo":"America/Caracas",
  "santiago":"America/Santiago","valparaiso":"America/Santiago","concepcion":"America/Santiago","punta arenas":"America/Punta_Arenas","easter island":"Pacific/Easter",
  "buenos aires":"America/Argentina/Buenos_Aires","cordoba ar":"America/Argentina/Cordoba","mendoza":"America/Argentina/Mendoza","rosario":"America/Argentina/Cordoba","ushuaia":"America/Argentina/Ushuaia",
  "sao paulo":"America/Sao_Paulo","rio de janeiro":"America/Sao_Paulo","brasilia":"America/Sao_Paulo","salvador":"America/Bahia","recife":"America/Recife","fortaleza":"America/Fortaleza","manaus":"America/Manaus","belem":"America/Belem","porto alegre":"America/Sao_Paulo","curitiba":"America/Sao_Paulo","belo horizonte":"America/Sao_Paulo","cuiaba":"America/Cuiaba","campo grande":"America/Campo_Grande","boa vista":"America/Boa_Vista","rio branco":"America/Rio_Branco","araguaina":"America/Araguaina",
  "georgetown":"America/Guyana","paramaribo":"America/Paramaribo","cayenne":"America/Cayenne",
  "kingston":"America/Jamaica","nassau":"America/Nassau","port au prince":"America/Port-au-Prince","santo domingo":"America/Santo_Domingo","port of spain":"America/Port_of_Spain","port_of_spain":"America/Port_of_Spain","bridgetown":"America/Barbados","castries":"America/St_Lucia","st george's":"America/Grenada","saint george's":"America/Grenada","roseau":"America/Dominica","st john's ag":"America/Antigua","the valley anguilla":"America/Anguilla","charlotte amalie":"America/St_Thomas","san juan":"America/Puerto_Rico","willemstad":"America/Curacao","oranjestad":"America/Aruba","kralendijk":"America/Kralendijk",

  // Europe (West/North)
  "london":"Europe/London","manchester":"Europe/London","birmingham uk":"Europe/London","leeds":"Europe/London","liverpool":"Europe/London","edinburgh":"Europe/London","glasgow":"Europe/London","belfast":"Europe/London","cardiff":"Europe/London","bristol":"Europe/London","oxford":"Europe/London","cambridge uk":"Europe/London",
  "dublin":"Europe/Dublin","cork":"Europe/Dublin","galway":"Europe/Dublin","limerick":"Europe/Dublin",
  "lisbon":"Europe/Lisbon","porto":"Europe/Lisbon","funchal":"Atlantic/Madeira","ponta delgada":"Atlantic/Azores",
  "paris":"Europe/Paris","lyon":"Europe/Paris","marseille":"Europe/Paris","toulouse":"Europe/Paris","nice":"Europe/Paris","nantes":"Europe/Paris","strasbourg":"Europe/Paris","lille":"Europe/Paris","bordeaux":"Europe/Paris","montpellier":"Europe/Paris",
  "brussels":"Europe/Brussels","antwerp":"Europe/Brussels","ghent":"Europe/Brussels","bruges":"Europe/Brussels",
  "amsterdam":"Europe/Amsterdam","rotterdam":"Europe/Amsterdam","the hague":"Europe/Amsterdam","utrecht":"Europe/Amsterdam","eindhoven":"Europe/Amsterdam",
  "luxembourg":"Europe/Luxembourg","monaco":"Europe/Monaco","andorra la vella":"Europe/Andorra","valletta":"Europe/Malta",

  // Europe (Central)
  "berlin":"Europe/Berlin","hamburg":"Europe/Berlin","munich":"Europe/Berlin","frankfurt":"Europe/Berlin","stuttgart":"Europe/Berlin","dusseldorf":"Europe/Berlin","leipzig":"Europe/Berlin","dresden":"Europe/Berlin","hannover":"Europe/Berlin","nuremberg":"Europe/Berlin","bremen":"Europe/Berlin","bonn":"Europe/Berlin","cologne":"Europe/Berlin",
  "vienna":"Europe/Vienna","salzburg":"Europe/Vienna","graz":"Europe/Vienna","innsbruck":"Europe/Vienna","linz":"Europe/Vienna",
  "zurich":"Europe/Zurich","geneva":"Europe/Zurich","basel":"Europe/Zurich","lausanne":"Europe/Zurich","bern":"Europe/Zurich","lugano":"Europe/Zurich",
  "prague":"Europe/Prague","brno":"Europe/Prague","ostrava":"Europe/Prague",
  "warsaw":"Europe/Warsaw","krakow":"Europe/Warsaw","wroclaw":"Europe/Warsaw","gdansk":"Europe/Warsaw","poznan":"Europe/Warsaw","lodz":"Europe/Warsaw",
  "budapest":"Europe/Budapest","debrecen":"Europe/Budapest","szeged":"Europe/Budapest",
  "bratislava":"Europe/Bratislava","kosice":"Europe/Bratislava",
  "ljubljana":"Europe/Ljubljana","maribor":"Europe/Ljubljana","zagreb":"Europe/Zagreb","split":"Europe/Zagreb","dubrovnik":"Europe/Zagreb","sarajevo":"Europe/Sarajevo","banja luka":"Europe/Sarajevo","belgrade":"Europe/Belgrade","novi sad":"Europe/Belgrade","podgorica":"Europe/Podgorica","tirana":"Europe/Tirane","skopje":"Europe/Skopje","sofia":"Europe/Sofia","bucharest":"Europe/Bucharest","cluj napoca":"Europe/Bucharest","timisoara":"Europe/Bucharest","iasi":"Europe/Bucharest",

  // Europe (South)
  "madrid":"Europe/Madrid","barcelona":"Europe/Madrid","valencia":"Europe/Madrid","seville":"Europe/Madrid","malaga":"Europe/Madrid","bilbao":"Europe/Madrid","zaragoza":"Europe/Madrid","palma de mallorca":"Europe/Madrid","las palmas":"Atlantic/Canary","santa cruz de tenerife":"Atlantic/Canary",
  "rome":"Europe/Rome","milan":"Europe/Rome","naples":"Europe/Rome","turin":"Europe/Rome","florence":"Europe/Rome","venice":"Europe/Rome","bologna":"Europe/Rome","genoa":"Europe/Rome","palermo":"Europe/Rome","catania":"Europe/Rome",
  "athens":"Europe/Athens","thessaloniki":"Europe/Athens","heraklion":"Europe/Athens","patras":"Europe/Athens","rhodes":"Europe/Athens",
  "valletta":"Europe/Malta","san marino":"Europe/Rome","vaduz":"Europe/Zurich",

  // Europe (East & Russia/Türkiye/Caucasus)
  "istanbul":"Europe/Istanbul","ankara":"Europe/Istanbul","izmir":"Europe/Istanbul","bursa":"Europe/Istanbul","antalya":"Europe/Istanbul","adana":"Europe/Istanbul","konya":"Europe/Istanbul","gaziantep":"Europe/Istanbul","trabzon":"Europe/Istanbul","diyarbakir":"Europe/Istanbul","edirne":"Europe/Istanbul",
  "moscow":"Europe/Moscow","saint petersburg":"Europe/Moscow","st petersburg":"Europe/Moscow","kazan":"Europe/Moscow","yekaterinburg":"Asia/Yekaterinburg","novosibirsk":"Asia/Novosibirsk","omsk":"Asia/Omsk","irkutsk":"Asia/Irkutsk","krasnoyarsk":"Asia/Krasnoyarsk","vladivostok":"Asia/Vladivostok","samara":"Europe/Samara","ufa":"Asia/Yekaterinburg","perm":"Asia/Yekaterinburg","khabarovsk":"Asia/Vladivostok","tomsk":"Asia/Tomsk","barnaul":"Asia/Barnaul","novokuznetsk":"Asia/Novokuznetsk",
  "kyiv":"Europe/Kyiv","lviv":"Europe/Kyiv","odesa":"Europe/Kyiv","kharkiv":"Europe/Kyiv","dnipro":"Europe/Kyiv",
  "minsk":"Europe/Minsk","chisinau":"Europe/Chisinau",
  "tbilisi":"Asia/Tbilisi","yerevan":"Asia/Yerevan","baku":"Asia/Baku",
  "jerusalem":"Asia/Jerusalem","tel aviv":"Asia/Jerusalem","haifa":"Asia/Jerusalem",
  "amman":"Asia/Amman","beirut":"Asia/Beirut","damascus":"Asia/Damascus","baghdad":"Asia/Baghdad","kuwait city":"Asia/Kuwait","riyadh":"Asia/Riyadh","jeddah":"Asia/Riyadh","mecca":"Asia/Riyadh","medina":"Asia/Riyadh","doha":"Asia/Qatar","manama":"Asia/Bahrain","muscat":"Asia/Muscat","dubai":"Asia/Dubai","abu dhabi":"Asia/Dubai","sharjah":"Asia/Dubai",

  // Central & South Asia
  "tehran":"Asia/Tehran","mashhad":"Asia/Tehran","isfahan":"Asia/Tehran","tabriz":"Asia/Tehran","shiraz":"Asia/Tehran",
  "kabul":"Asia/Kabul","ashgabat":"Asia/Ashgabat","tashkent":"Asia/Tashkent","samarkand":"Asia/Samarkand","almaty":"Asia/Almaty","astana":"Asia/Almaty","nur sultan":"Asia/Almaty","bishkek":"Asia/Bishkek","dushanbe":"Asia/Dushanbe",
  "islamabad":"Asia/Karachi","karachi":"Asia/Karachi","lahore":"Asia/Karachi","rawalpindi":"Asia/Karachi",
  "delhi":"Asia/Kolkata","new delhi":"Asia/Kolkata","mumbai":"Asia/Kolkata","kolkata":"Asia/Kolkata","chennai":"Asia/Kolkata","bengaluru":"Asia/Kolkata","bangalore":"Asia/Kolkata","hyderabad in":"Asia/Kolkata","pune":"Asia/Kolkata","ahmedabad":"Asia/Kolkata","jaipur":"Asia/Kolkata","kochi":"Asia/Kolkata",
  "kathmandu":"Asia/Kathmandu","thimphu":"Asia/Thimphu","colombo":"Asia/Colombo","male":"Indian/Maldives","dhaka":"Asia/Dhaka",

  // Southeast Asia
  "yangon":"Asia/Yangon","naypyidaw":"Asia/Yangon",
  "bangkok":"Asia/Bangkok","phuket":"Asia/Bangkok","chiang mai":"Asia/Bangkok",
  "hanoi":"Asia/Ho_Chi_Minh","ho chi minh city":"Asia/Ho_Chi_Minh","saigon":"Asia/Ho_Chi_Minh","da nang":"Asia/Ho_Chi_Minh",
  "vientiane":"Asia/Vientiane","phnom penh":"Asia/Phnom_Penh",
  "kuala lumpur":"Asia/Kuala_Lumpur","george town penang":"Asia/Kuala_Lumpur","kuching":"Asia/Kuching","kota kinabalu":"Asia/Kuching",
  "singapore":"Asia/Singapore",
  "jakarta":"Asia/Jakarta","bandung":"Asia/Jakarta","surabaya":"Asia/Jakarta","yogyakarta":"Asia/Jakarta","denpasar":"Asia/Makassar","bali":"Asia/Makassar","medan":"Asia/Jakarta","makassar":"Asia/Makassar","jayapura":"Asia/Jayapura",
  "manila":"Asia/Manila","cebu city":"Asia/Manila","davao":"Asia/Manila","iloilo city":"Asia/Manila","bacolod":"Asia/Manila","cagayan de oro":"Asia/Manila","general santos":"Asia/Manila","taguig":"Asia/Manila","quezon city":"Asia/Manila","pasig":"Asia/Manila","makati":"Asia/Manila","pasay":"Asia/Manila","caloocan":"Asia/Manila","mandaluyong":"Asia/Manila",

  // East Asia
  "beijing":"Asia/Shanghai","shanghai":"Asia/Shanghai","shenzhen":"Asia/Shanghai","guangzhou":"Asia/Shanghai","chengdu":"Asia/Shanghai","chongqing":"Asia/Chongqing","tianjin":"Asia/Shanghai","wuhan":"Asia/Shanghai","xi'an":"Asia/Shanghai","xian":"Asia/Shanghai","hangzhou":"Asia/Shanghai","nanjing":"Asia/Shanghai","suzhou":"Asia/Shanghai","qingdao":"Asia/Shanghai","dalian":"Asia/Shanghai","harbin":"Asia/Harbin",
  "hong kong":"Asia/Hong_Kong","macau":"Asia/Macau",
  "taipei":"Asia/Taipei","kaohsiung":"Asia/Taipei","taichung":"Asia/Taipei",
  "tokyo":"Asia/Tokyo","osaka":"Asia/Tokyo","kyoto":"Asia/Tokyo","yokohama":"Asia/Tokyo","sapporo":"Asia/Tokyo","fukuoka":"Asia/Tokyo","nagoya":"Asia/Tokyo","kobe":"Asia/Tokyo","hiroshima":"Asia/Tokyo","sendai":"Asia/Tokyo","naha":"Asia/Tokyo",
  "seoul":"Asia/Seoul","incheon":"Asia/Seoul","busan":"Asia/Seoul","daegu":"Asia/Seoul","daejeon":"Asia/Seoul","gwangju kr":"Asia/Seoul","ulsan":"Asia/Seoul",

  // Western Asia & Middle East (extras)
  "isfahan":"Asia/Tehran","esfahan":"Asia/Tehran","doha":"Asia/Qatar","manama":"Asia/Bahrain","sana'a":"Asia/Aden","sanaa":"Asia/Aden","aden":"Asia/Aden",

  // Africa (North & West)
  "cairo":"Africa/Cairo","alexandria eg":"Africa/Cairo","giza":"Africa/Cairo",
  "casablanca":"Africa/Casablanca","rabat":"Africa/Casablanca","marrakesh":"Africa/Casablanca","marrakech":"Africa/Casablanca","tangier":"Africa/Casablanca",
  "algiers":"Africa/Algiers","oran":"Africa/Algiers","constantine":"Africa/Algiers",
  "tunis":"Africa/Tunis","tripoli ly":"Africa/Tripoli",
  "lagos":"Africa/Lagos","abuja":"Africa/Lagos","ibadan":"Africa/Lagos","kano":"Africa/Lagos","port harcourt":"Africa/Lagos",
  "accra":"Africa/Accra","kumasi":"Africa/Accra",
  "abidjan":"Africa/Abidjan","dakar":"Africa/Dakar","bamako":"Africa/Bamako","conakry":"Africa/Conakry","freetown":"Africa/Freetown","banjul":"Africa/Banjul","bissau":"Africa/Bissau","monrovia":"Africa/Monrovia","ouagadougou":"Africa/Ouagadougou","niamey":"Africa/Niamey","lome":"Africa/Lome","porto novo":"Africa/Porto-Novo","cotonou":"Africa/Porto-Novo","nouakchott":"Africa/Nouakchott","praia":"Atlantic/Cape_Verde",

  // Africa (Central, East & South)
  "nairobi":"Africa/Nairobi","mombasa":"Africa/Nairobi","kampala":"Africa/Kampala","addis ababa":"Africa/Addis_Ababa","dar es salaam":"Africa/Dar_es_Salaam","arusha":"Africa/Dar_es_Salaam","lusaka":"Africa/Lusaka","harare":"Africa/Harare","maputo":"Africa/Maputo","antananarivo":"Indian/Antananarivo","victoria seychelles":"Indian/Mahe","mahe":"Indian/Mahe","moroni":"Indian/Comoro","port louis":"Indian/Mauritius","saint denis re":"Indian/Reunion",
  "johannesburg":"Africa/Johannesburg","pretoria":"Africa/Johannesburg","cape town":"Africa/Johannesburg","durban":"Africa/Johannesburg","gaborone":"Africa/Gaborone","windhoek":"Africa/Windhoek","mbabane":"Africa/Johannesburg","maseru":"Africa/Johannesburg","antananarivo mg":"Indian/Antananarivo",

  // Oceania
  "sydney":"Australia/Sydney","melbourne":"Australia/Melbourne","brisbane":"Australia/Brisbane","gold coast":"Australia/Brisbane","canberra":"Australia/Sydney","hobart":"Australia/Hobart","adelaide":"Australia/Adelaide","perth":"Australia/Perth","darwin":"Australia/Darwin","alice springs":"Australia/Darwin",
  "auckland":"Pacific/Auckland","wellington":"Pacific/Auckland","christchurch":"Pacific/Auckland","dunedin":"Pacific/Auckland",
  "suva":"Pacific/Fiji","nadi":"Pacific/Fiji","apia":"Pacific/Apia","nuku alofa":"Pacific/Tongatapu","port moresby":"Pacific/Port_Moresby","honiara":"Pacific/Guadalcanal","port vila":"Pacific/Efate","palikir":"Pacific/Pohnpei","majuro":"Pacific/Majuro","kwajalein":"Pacific/Kwajalein","tarawa":"Pacific/Tarawa","funafuti":"Pacific/Funafuti","palau":"Pacific/Palau","noumea":"Pacific/Noumea","papeete":"Pacific/Tahiti","rikitea":"Pacific/Gambier","rarotonga":"Pacific/Rarotonga","niue":"Pacific/Niue","midway":"Pacific/Midway","chatham":"Pacific/Chatham","norfolk island":"Pacific/Norfolk","lord howe":"Australia/Lord_Howe","pitcairn":"Pacific/Pitcairn","galapagos":"Pacific/Galapagos","easter island":"Pacific/Easter",
  "port chalmers":"Pacific/Auckland",

  // Antarctica
  "mcmurdo":"Antarctica/McMurdo","rothera":"Antarctica/Rothera","troll":"Antarctica/Troll","davis":"Antarctica/Davis","casey":"Antarctica/Casey","mawson":"Antarctica/Mawson","vostok":"Antarctica/Vostok","syowa":"Antarctica/Syowa","palmer":"Antarctica/Palmer",

  // Middle & South Atlantic islands
  "st helena":"Atlantic/St_Helena","stanley":"Atlantic/Stanley","reykjavik":"Atlantic/Reykjavik","praia cv":"Atlantic/Cape_Verde","faial":"Atlantic/Azores",

  // UAE & Gulf aliases (extra)
  "al ain":"Asia/Dubai","ras al khaimah":"Asia/Dubai","fujairah":"Asia/Dubai","ajman":"Asia/Dubai",

  // Additional city aliases (Europe extras)
  "oslo":"Europe/Oslo","bergen":"Europe/Oslo","stockholm":"Europe/Stockholm","gothenburg":"Europe/Stockholm","malmo":"Europe/Stockholm","uppsala":"Europe/Stockholm",
  "helsinki":"Europe/Helsinki","tampere":"Europe/Helsinki","turku":"Europe/Helsinki","oulu":"Europe/Helsinki",
  "copenhagen":"Europe/Copenhagen","aarhus":"Europe/Copenhagen","odense":"Europe/Copenhagen",
  "reykjavik":"Atlantic/Reykjavik","faroe":"Atlantic/Faroe","torshavn":"Atlantic/Faroe",
  "vilnius":"Europe/Vilnius","kaunas":"Europe/Vilnius","klaipeda":"Europe/Vilnius",
  "riga":"Europe/Riga","daugavpils":"Europe/Riga",
  "tallinn":"Europe/Tallinn","tartu":"Europe/Tallinn",

  // North Africa & Levant extras
  "jericho":"Asia/Jerusalem","gaza city":"Asia/Gaza","hebron":"Asia/Hebron","nablus":"Asia/Hebron",
  "suez":"Africa/Cairo","aswan":"Africa/Cairo","luxor":"Africa/Cairo","tripoli lb":"Asia/Beirut", // common confusion alias

  // More South Asia aliases
  "sri jayawardenepura kotte":"Asia/Colombo","kotte":"Asia/Colombo","trivandrum":"Asia/Kolkata","thiruvananthapuram":"Asia/Kolkata",
  "goa":"Asia/Kolkata","lucknow":"Asia/Kolkata","bhopal":"Asia/Kolkata","kanpur":"Asia/Kolkata","patna":"Asia/Kolkata","guwahati":"Asia/Kolkata","ranchi":"Asia/Kolkata","coimbatore":"Asia/Kolkata","visakhapatnam":"Asia/Kolkata","vishakhapatnam":"Asia/Kolkata","kozhikode":"Asia/Kolkata","calicut":"Asia/Kolkata","mysuru":"Asia/Kolkata","mysore":"Asia/Kolkata","vijayawada":"Asia/Kolkata","erode":"Asia/Kolkata","madurai":"Asia/Kolkata","tiruchirappalli":"Asia/Kolkata","trichy":"Asia/Kolkata","varanasi":"Asia/Kolkata","agra":"Asia/Kolkata","srinagar":"Asia/Kolkata","amritsar":"Asia/Kolkata","chandigarh":"Asia/Kolkata","noida":"Asia/Kolkata","gurugram":"Asia/Kolkata","gurgaon":"Asia/Kolkata",
  "peshawar":"Asia/Karachi","quetta":"Asia/Karachi","multan":"Asia/Karachi","faisalabad":"Asia/Karachi",
  "chittagong":"Asia/Dhaka","khulna":"Asia/Dhaka","sylhet":"Asia/Dhaka",

  // China aliases (extras)
  "urumqi":"Asia/Urumqi","kashgar":"Asia/Urumqi","urumchi":"Asia/Urumqi","lhasa":"Asia/Urumqi", // official IANA lacks Asia/Lhasa; many map Tibet to Asia/Urumqi
  "nanchang":"Asia/Shanghai","zhengzhou":"Asia/Shanghai","taiyuan":"Asia/Shanghai","changsha":"Asia/Shanghai","haikou":"Asia/Shanghai","sanya":"Asia/Shanghai","xiamen":"Asia/Shanghai","fuzhou":"Asia/Shanghai","jinan":"Asia/Shanghai","shenyang":"Asia/Shanghai","changchun":"Asia/Shanghai","ningbo":"Asia/Shanghai","wuxi":"Asia/Shanghai","dongguan":"Asia/Shanghai","foshan":"Asia/Shanghai","wenzhou":"Asia/Shanghai",

  // Japan & Korea extras
  "okinawa":"Asia/Tokyo","kawasaki":"Asia/Tokyo","saitama":"Asia/Tokyo","chiba":"Asia/Tokyo","kitakyushu":"Asia/Tokyo","kumamoto":"Asia/Tokyo","niigata":"Asia/Tokyo","kanazawa":"Asia/Tokyo","nagano":"Asia/Tokyo","akita":"Asia/Tokyo","aomori":"Asia/Tokyo","morioka":"Asia/Tokyo","matsuyama":"Asia/Tokyo","tokushima":"Asia/Tokyo","takamatsu":"Asia/Tokyo",
  "gyeonggi":"Asia/Seoul","jeju":"Asia/Seoul","gwangju":"Asia/Seoul","suwon":"Asia/Seoul","ilsan":"Asia/Seoul","daegu":"Asia/Seoul",

  // Indonesia & Philippines extras
  "bandar lampung":"Asia/Jakarta","palembang":"Asia/Jakarta","padang":"Asia/Jakarta","pekanbaru":"Asia/Jakarta","batam":"Asia/Jakarta","pontianak":"Asia/Pontianak","banjarmasin":"Asia/Makassar","manado":"Asia/Makassar","ambon":"Asia/Jayapura","sorong":"Asia/Jayapura",
  "quezon":"Asia/Manila","antipolo":"Asia/Manila","calamba":"Asia/Manila","binan":"Asia/Manila","san pedro laguna":"Asia/Manila","santa rosa laguna":"Asia/Manila","angeles city":"Asia/Manila","olongapo":"Asia/Manila","subic":"Asia/Manila","bataan":"Asia/Manila","pampanga":"Asia/Manila","baguio":"Asia/Manila","laoag":"Asia/Manila","vigan":"Asia/Manila","tacloban":"Asia/Manila","dumaguete":"Asia/Manila","roxas city":"Asia/Manila","legazpi":"Asia/Manila","naga":"Asia/Manila","butuan":"Asia/Manila","surigao":"Asia/Manila","zamboanga":"Asia/Manila","cotabato":"Asia/Manila","pagadian":"Asia/Manila","sultan kudarat":"Asia/Manila","kidapawan":"Asia/Manila",

  // Australia extras
  "geelong":"Australia/Melbourne","ballarat":"Australia/Melbourne","wollongong":"Australia/Sydney","newcastle nsw":"Australia/Sydney","townsville":"Australia/Brisbane","cairns":"Australia/Brisbane","toowoomba":"Australia/Brisbane","launceston":"Australia/Hobart","whyalla":"Australia/Adelaide","mount gambier":"Australia/Adelaide","geraldton":"Australia/Perth","broome":"Australia/Perth","kalgoorlie":"Australia/Perth",

  // New Zealand extras
  "hamilton nz":"Pacific/Auckland","tauranga":"Pacific/Auckland","napier":"Pacific/Auckland","hastings nz":"Pacific/Auckland","palmerston north":"Pacific/Auckland","nelson nz":"Pacific/Auckland","rotorua":"Pacific/Auckland","whangarei":"Pacific/Auckland","gisborne":"Pacific/Auckland","invercargill":"Pacific/Auckland",

  // Central America extras
  "antigua guatemala":"America/Guatemala","quetzaltenango":"America/Guatemala","bluefields":"America/Managua","leon ni":"America/Managua",

  // South America extras
  "arequipa":"America/Lima","trujillo pe":"America/Lima","cuzco":"America/Lima","cusco":"America/Lima",
  "valledupar":"America/Bogota","barranquilla":"America/Bogota","cartagena co":"America/Bogota","pereira":"America/Bogota","bucaramanga":"America/Bogota",
  "mar del plata":"America/Argentina/Buenos_Aires","neuquen":"America/Argentina/Neuquen","salta":"America/Argentina/Salta","posadas":"America/Argentina/Cordoba",
  "curitiba":"America/Sao_Paulo","goiania":"America/Sao_Paulo","joao pessoa":"America/Fortaleza","maceio":"America/Maceio","santarem":"America/Santarem","porto velho":"America/Porto_Velho","macapa":"America/Belem",

  // Caribbean extras
  "san juan pr":"America/Puerto_Rico","caguas":"America/Puerto_Rico","ponce":"America/Puerto_Rico","mayaguez":"America/Puerto_Rico",
  "cap haitien":"America/Port-au-Prince","santiago de los caballeros":"America/Santo_Domingo","santo domingo este":"America/Santo_Domingo","la romana":"America/Santo_Domingo",
  "george town cayman":"America/Cayman","kingstown":"America/St_Vincent","castries lc":"America/St_Lucia",

  // Indian Ocean & Subantarctic
  "reunion":"Indian/Reunion","mauritius":"Indian/Mauritius","port louis mu":"Indian/Mauritius","antananarivo mg":"Indian/Antananarivo",
  "kerguelen":"Indian/Kerguelen","chagos":"Indian/Chagos",

  // GMT/UTC & Etc
  "gmt":"Etc/GMT","utc":"UTC","greenwich":"Europe/London","iceland":"Atlantic/Reykjavik",

  // Special territories
  "jersey":"Europe/Jersey","guernsey":"Europe/Guernsey","isle of man":"Europe/Isle_of_Man","gibraltar":"Europe/Gibraltar","ceuta":"Africa/Ceuta","melilla":"Africa/Ceuta",
  "madeira":"Atlantic/Madeira","azores":"Atlantic/Azores","canary islands":"Atlantic/Canary",

  // Additional Middle East & Caucasus extras
  "erbil":"Asia/Baghdad","sulaymaniyah":"Asia/Baghdad","mosul":"Asia/Baghdad","aleppo":"Asia/Damascus","homs":"Asia/Damascus",
  "shiraz":"Asia/Tehran","ahvaz":"Asia/Tehran","qom":"Asia/Tehran","karaj":"Asia/Tehran",

  // Turkey extras (aliases)
  "izmit":"Europe/Istanbul","eskisehir":"Europe/Istanbul","kayseri":"Europe/Istanbul","samsun":"Europe/Istanbul","malatya":"Europe/Istanbul","van":"Europe/Istanbul","gaziosmanpasa":"Europe/Istanbul","mersin":"Europe/Istanbul","hatay":"Europe/Istanbul","sanliurfa":"Europe/Istanbul","kocaeli":"Europe/Istanbul",

  // UAE/KSA extras
  "al khobar":"Asia/Riyadh","dammam":"Asia/Riyadh","taif":"Asia/Riyadh","tabuk":"Asia/Riyadh","abha":"Asia/Riyadh",

  // Palestine extras
  "netanya":"Asia/Jerusalem","ashdod":"Asia/Jerusalem","beer sheva":"Asia/Jerusalem","beersheba":"Asia/Jerusalem","nazareth":"Asia/Jerusalem","ramallah":"Asia/Hebron"
};


    const timezone = tzMap[location.toLowerCase()];
    if (!timezone) return null;

    const now = new Date();
    const options = { timeZone: timezone, timeStyle: 'medium', hour12: false };
    return now.toLocaleTimeString('en-US', options);
}

function randomCompliment() {
    const compliments = [
        "You’re an awesome friend.",
        "You light up the room.",
        "You have a great sense of humor.",
        "You make a difference.",
        "You're like a ray of sunshine."
    ];
    return compliments[Math.floor(Math.random() * compliments.length)];
}

function randomEncouragement() {
    const encourages = [
        "Keep going—you’ve got this!",
        "Don’t give up now!",
        "Every step counts.",
        "Believe in yourself.",
        "You can do anything."
    ];
    return encourages[Math.floor(Math.random() * encourages.length)];
}

function base64Encode(str) { return btoa(str); }
function base64Decode(str) { try { return atob(str); } catch { return 'Invalid Base64'; } }
function hexToDec(str) { return parseInt(str.replace(/^0x/, ''), 16).toString(); }
function decToHex(num) { return Number(num).toString(16); }
function textToCharCodes(text) { return text.split('').map(c => c.charCodeAt(0)).join(' '); }
function charCodesToText(codes) { return String.fromCharCode(...codes.split(/\s+/).map(n => +n)); }
function countWords(text) { return text.trim().split(/\s+/).length; }
function titleCase(text) { return text.split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1).toLowerCase()).join(' '); }
function slugify(text) { return text.toLowerCase().trim().replace(/[^a-z0-9]+/g, '-').replace(/^-+|-+$/g, ''); }

function isPrime(n) {
    n = Number(n);
    if (n < 2) return false;
    for (let i = 2; i <= Math.sqrt(n); i++) if (n % i === 0) return false;
    return true;
}

function gcd(a, b) { a = Math.abs(a); b = Math.abs(b); while (b) [a, b] = [b, a % b]; return a; }
function lcm(a, b) { return Math.abs(a * b) / gcd(a, b); }

function fibonacci(n) {
    n = Number(n);
    if (n < 2) return n;
    let a = 0, b = 1;
    for (let i = 2; i <= n; i++) [a, b] = [b, a + b];
    return b;
}

function generatePassword(length = 8) {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()';
    let pw = '';
    for (let i = 0; i < length; i++) pw += chars.charAt(Math.floor(Math.random() * chars.length));
    return pw;
}

function daysUntil(dateStr) {
    const now = new Date();
    const then = new Date(dateStr);
    const diff = then - now;
    return diff > 0 ? Math.ceil(diff / (1000 * 60 * 60 * 24)) + ' days' : 'Date passed';
}

function generateUUID() {
    return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>
        (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
    );
}

function generateRandomString(length = 8) {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    let s = '';
    for (let i = 0; i < length; i++) s += chars.charAt(Math.floor(Math.random() * chars.length));
    return s;
}

const emojiMap = {
    "grinning face":"😀","grin":"😁","smiley":"😃","smile":"😄","sweat smile":"😅","joy":"😂","rofl":"🤣","relaxed":"☺️","blush":"😊","innocent":"😇",
    "slightly_smiling_face":"🙂","upside_down":"🙃","wink":"😉","relieved":"😌","heart eyes":"😍","kissing_heart":"😘","kissing":"😗","kissing_smiling_eyes":"😙","kissing_closed_eyes":"😚",
    "yum":"😋","stuck out tongue":"😛","stuck out tongue wink":"😜","stuck out tongue closed eyes":"😝","money_mouth":"🤑","hug":"🤗","nerd":"🤓","sunglasses":"😎","star_struck":"🤩",
    "thinking":"🤔","zipper_mouth":"🤐","raised_eyebrow":"🤨","neutral":"😐","expressionless":"😑","no_mouth":"😶","roll_eyes":"🙄","smirk":"😏","persevere":"😣","disappointed_relieved":"😥",
    "cold_sweat":"😰","pensive":"😔","confused":"😕","worried":"😟","slightly_frowning":"🙁","frowning":"☹️","anguished":"😧","open_mouth":"😮","grimacing":"😬","hushed":"😯","astonished":"😲",
    "flushed":"😳","pleading":"🥺","frowning2":"😦","anguished2":"😧","cry":"😢","disappointed":"😞","scream":"😱","fearful":"😨","tired_face":"😫","weary":"😩","triumph":"😤",
    "angry":"😠","rage":"😡","poop":"💩","thumbsup":"👍","thumbsdown":"👎","clap":"👏","raised_hands":"🙌","pray":"🙏","muscle":"💪","eyes":"👀","ear":"👂","nose":"👃","tongue":"👅",
    "lips":"👄","kiss":"💋","crown":"👑","womans hat":"👒","eyeglasses":"👓","necktie":"👔","shirt":"👕","jeans":"👖","dress":"👗","kimono":"👘","bikini":"👙","sandal":"👡","boot":"👢",
    "mans shoe":"👞","high heel":"👠","sock":"🧦","gloves":"🧤","scarf":"🧣","tophat":"🎩","billed cap":"🧢","flag us":"🇺🇸","flag gb":"🇬🇧","flag ca":"🇨🇦","flag de":"🇩🇪","flag fr":"🇫🇷",
    "flag es":"🇪🇸","flag it":"🇮🇹","flag jp":"🇯🇵","flag cn":"🇨🇳","flag in":"🇮🇳","flag br":"🇧🇷","flag ru":"🇷🇺","flag za":"🇿🇦","flag au":"🇦🇺","flag nz":"🇳🇿","flag ng":"🇳🇬","flag eg":"🇪🇬",
    "flag ar":"🇦🇷","flag mx":"🇲🇽","flag kr":"🇰🇷","flag tr":"🇹🇷",
    "dog face":"🐶","cat face":"🐱","mouse face":"🐭","hamster":"🐹","rabbit":"🐰","fox face":"🦊","bear face":"🐻","koala":"🐨","tiger face":"🐯","lion face":"🦁","cow face":"🐮","pig face":"🐷",
    "frog face":"🐸","octopus":"🐙","monkey face":"🐵","chicken":"🐔","penguin":"🐧","bird":"🐦","baby chick":"🐤","hatching chick":"🐣",
    "sun":"☀️","moon":"🌙","star":"⭐️","cloud":"☁️","umbrella":"☂️","snowflake":"❄️","fire":"🔥","droplet":"💧","ocean":"🌊","volcano":"🌋","cactus":"🌵","palm tree":"🌴","evergreen tree":"🌲",
    "deciduous tree":"🌳","fallen leaf":"🍂","maple leaf":"🍁","seedling":"🌱","flower":"🌸","rose":"🌹","sunflower":"🌻","blossom":"🌼",
    "grapes":"🍇","watermelon":"🍉","tangerine":"🍊","banana":"🍌","pineapple":"🍍","apple":"🍎","pear":"🍐","peach":"🍑","strawberry":"🍓","cherries":"🍒","mango":"🥭","lemon":"🍋",
    "coffee":"☕️","tea":"🍵","beer":"🍺","wine glass":"🍷","cocktail":"🍸","tropical drink":"🍹","birthday cake":"🎂","pizza":"🍕","hamburger":"🍔","fries":"🍟","hot dog":"🌭","taco":"🌮",
    "burrito":"🌯","popcorn":"🍿","chocolate bar":"🍫","candy":"🍬","lollipop":"🍭","honey pot":"🍯"
};

let m;

if (isMathExpression(query)) {
    answer = evaluateMathExpression(query);
} else if (query.includes('date') || query.includes('what date is it')) {
    answer = getCurrentDate();
} else if (query.includes('year') || query.includes('what year is it')) {
    answer = getCurrentYear();
} else if (query.includes('what time is it in')) {
    const location = query.split('what time is it in')[1].trim();
    answer = getTimeInTimezone(location) || 'Unknown location';
} else if (query.includes('what time is it')) {
    answer = new Date().toLocaleTimeString();
} else if (query.includes('day') || query.includes('what day is it')) {
    const now = new Date();
    const options = { weekday: 'long' };
    answer = now.toLocaleDateString(undefined, options);
} else if (query.includes('u are cute') || query.includes('you are cute')) {
    answer = "jifshfgdhjf >~< no u";
} else if (query.includes('ur cute') || query.includes('your cute')) {
    answer = "efkohgefgef >///< no u";
} else if (query.includes('am i cute') || query.includes('am i a cutie?')) {
    answer = "yesh :3 u are ";
} else if (query.includes('am i a good girl') || query.includes('am i a good boy?')) {
    answer = query.includes('girl') ? "yesh :3 u are a good girl" : "yesh :3 u are a good boy";
} else if (query.includes('ur hot') || query.includes('you are hot')) {
    answer = "jrifyehgyerfgu9wdswgfsafgydwgbfwdfge >~< ";
} else if (/^(?:emoji\s+(.+)|(.+)\s+emoji)$/.test(query)) {
    const match = query.match(/^(?:emoji\s+(.+)|(.+)\s+emoji)$/);
    let name = (match[1] || match[2]).trim().toLowerCase();
    const keySpace = name.replace(/_/g, ' ');
    const keyUnderscore = name.replace(/\s+/g, '_');
    answer = emojiMap[keySpace] || emojiMap[keyUnderscore] || 'Unknown emoji';
} else if (query.includes('compliment')) {
    answer = randomCompliment();
} else if (query.includes('encouragement') || query.includes('encourage me')) {
    answer = randomEncouragement();
} else if (query.startsWith('base64 encode ')) {
    answer = base64Encode(query.slice(14));
} else if (query.startsWith('base64 decode ')) {
    answer = base64Decode(query.slice(14));
} else if ((m = /0x[0-9a-f]+/i.exec(query))) {
    answer = hexToDec(m[0]);
} else if (/\d+\s+to\s+hex/i.test(query)) {
    answer = decToHex(query.match(/\d+/)[0]);
} else if (query.startsWith('char codes for ')) {
    answer = textToCharCodes(query.slice(15));
} else if (query.startsWith('text from codes ')) {
    answer = charCodesToText(query.slice(16));
} else if (query.startsWith('word count of ')) {
    answer = String(countWords(query.slice(14)));
} else if (query.startsWith('titlecase ')) {
    answer = titleCase(query.slice(10));
} else if (query.startsWith('slugify ')) {
    answer = slugify(query.slice(8));
} else if (/\bprime\b/.test(query)) {
    const n = query.match(/\d+/);
    answer = n ? (isPrime(n[0]) ? 'Yes' : 'No') : 'No';
} else if (query.includes('gcd of ')) {
    const nums = query.match(/\d+/g);
    answer = nums ? String(gcd(nums[0], nums[1])) : 'Invalid';
} else if (query.includes('lcm of ')) {
    const nums = query.match(/\d+/g);
    answer = nums ? String(lcm(nums[0], nums[1])) : 'Invalid';
} else if (/fib(?:onacci)?\s*\d+/i.test(query)) {
    answer = String(fibonacci(query.match(/\d+/)[0]));
} else if (query.startsWith('generate password')) {
    const n = query.match(/\d+/);
    answer = generatePassword(n ? Number(n[0]) : undefined);
} else if (query.includes('days until ')) {
    answer = daysUntil(query.split('days until ')[1].trim());
} else if (query.includes('uuid')) {
    answer = generateUUID();
} else if (query.startsWith('random string')) {
    const n = query.match(/\d+/);
    answer = generateRandomString(n ? Number(n[0]) : undefined);
}

const upsellMessages = [
    "[new] Try searching 'What's 4+4?'",
    "[new] Ask 'What's the date today?'",
    "[new] Try 'What time is it in California?'",
    "[new] Ask 'What's the current year?'",
    "[new] Try searching 'What's 7*8?'"
];

const showUpsell = !answer && Math.random() < 0.1;
const randomUpsellMessage = showUpsell
    ? upsellMessages[Math.floor(Math.random() * upsellMessages.length)]
    : '';

function extractQueryFromUpsellMessage(message) {
    return message
        .replace("[new] Try searching '", "")
        .replace("[new] Try '", "")
        .replace("[new] Ask '", "")
        .replace("[new] Try ", "")
        .replace("'", "")
        .replace("?", "")
        .trim();
}
%>

%>
%>
<% if (answer) { %>
<div class="container" style="padding: 1em;">
  <h2 style="font-family: 'PokeTube Flex'; font-size: large; text-align: left !important; font-stretch: ultra-expanded; font-weight: 1000; margin-bottom: -0.1em;">
    Answer to ur question
  </h2>
  <h2 style="font-family: 'PokeTube Flex'; font-size: large; text-align: right !important; font-stretch: ultra-expanded; font-weight: 1000; margin-bottom: -0.1em; margin-top: -1em;">
    <i title="PokeIntellagance!" class="fa-light fa-sparkles"></i>
  </h2>
  <span
    id="answer-text"
    style="
      display: block;
      font-size: 7em;
      white-space: pre-wrap;
      word-break: break-word;
    "
  ><%= String(answer || '') %></span>
  <div style="display: flex; gap: 1em;">
    <button
      id="copy-btn"
      style="
        font-size: 1em;
        padding: 0.5em 1em;
        cursor: pointer;
        background: #222;
        color: #fff;
        border: none;
        border-radius: 0.25em;
      "
    >Copy</button>
    <button
      id="ask-btn"
      style="font-size:1em; padding:0.5em 1em;"
    >Ask ChatGPT</button>
  </div>
</div>

<noscript>
  <style>
    #copy-btn,
    #ask-btn {
      display: none !important;
    }
  </style>
</noscript>

<style>
  /* Rainbow border keyframes */
  @keyframes rainbow-border {
    0%   { border-color: red; }
    16%  { border-color: orange; }
    32%  { border-color: yellow; }
    48%  { border-color: green; }
    64%  { border-color: blue; }
    80%  { border-color: indigo; }
    100% { border-color: violet; }
  }

  #ask-btn {
    background: linear-gradient(45deg, #6a11cb, #2575fc);
    color: #fff;
    border: 2px solid transparent;            /* base border */
    border-radius: 0.5em;
    padding: 0.6em 1.2em;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    transition: transform 0.1s ease, box-shadow 0.2s ease;
  }
  #ask-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    animation: rainbow-border 2s linear infinite;  /* apply rainbow */
  }
  #ask-btn:active {
    transform: translateY(0);
    box-shadow: 0 3px 10px rgba(0,0,0,0.2);
  }
</style>

<script>
;(function() {
  const copyBtn = document.getElementById('copy-btn');
  const askBtn  = document.getElementById('ask-btn');
  const textEl  = document.getElementById('answer-text');

  copyBtn.addEventListener('click', () => {
    const text = textEl.innerText || textEl.textContent;
    navigator.clipboard.writeText(text).then(() => {
      copyBtn.textContent = 'Copied!';
      setTimeout(() => { copyBtn.textContent = 'Copy'; }, 1500);
    });
  });

  askBtn.addEventListener('click', () => {
    const userQuery = prompt('What would you like to ask ChatGPT?');
    if (userQuery) {
      window.location.href = `/sex`;
    }
  });
})();
</script>
<% } else if (showUpsell) { %>
<% } %>

 
<% if (q == "ai" || q == "aibot" || q == "chatbot") { %>  
<div class="container">
    <h2 style="font-family: 'PokeTube Flex'; font-size: large; text-align: center !important; font-stretch: ultra-expanded; font-weight: 1000; margin-bottom: -0.1em;">
        No, POKE Will Never Have "AI" —Because It Doesn't Need It
    </h2>
    <span style="margin-bottom: 3em; text-align: left !important; margin-right: 7em; white-space: pre-wrap; word-break: break-word;">
         POKE doesn’t need "AI." There’s no good reason for a YouTube front end to include some gimmicky AI assistant. These days, "AI" just means slapping a ChatGPT wrapper on an app, calling it innovative, and hoping no one notices the lack of actual purpose. It’s the latest fad, sure, but POKE is about simplicity, privacy, and doing things right—not just joining tech trends for the sake of it.  
        <br><br>
        POKE is here to make watching videos smoother, not cluttered with unnecessary "features." Real value doesn’t come from chasing whatever big tech wants to sell you on. It’s about staying true to what actually helps users. So, yeah, no AI here, and honestly, no need for it. POKE’s got you covered without any fluff.
    </span>
</div>
<% } %>
<%
// --- CONFIGURATION ---

// 1. THE SAFE LIST (Whitelist)
// Phrases that contain trigger words but are safe (idioms, song titles).
const safePhrases = [
    "die for you",
    "ride or die",
    "die hard",
    "to die for",
    "kill time",
    "killing it",
    "kill the lights",
    "murder mystery",
    "murder on the dancefloor"
];

// 2. CRITICAL TRIGGERS (Immediate Flag)
// Phrases that trigger the warning immediately.
const criticalTriggers = [
    /suicid/i, 
    /kill myself/i,
    /end my life/i,
    /hurt myself/i,
    /self[\s-]?harm/i, 
    /take my own life/i,
    /full stop punctuation/i 
];

// 3. CONTEXTUAL KEYWORDS (The "Point System")
// Suspicious words that accumulate risk points.
const ambiguousKeywords = [
    { word: "die", score: 2 },
    { word: "kill", score: 2 },
    { word: "death", score: 1 },
    { word: "gone", score: 1 },
    // "end it" is tricky with regex word boundaries if "it" is followed by punctuation
    // we handle it here as a regex to catch "end it", "ending it", "end things"
    { regex: /end(ing)?\s+(it|things|everything|life)/i, score: 3 }, 
    { word: "pain", score: 1 },
    { word: "abuse", score: 3 },
    { word: "run away", score: 3 }
];

// 4. INTENT INDICATORS (Amplifiers)
// Words that suggest personal intent/feeling.
const intentIndicators = [
    "i want to",
    "i'm going to",
    "im going to",
    "i need to",
    "wish i",
    "feel like",
    "tired of",
    "can't take it"
];

// --- THE LOGIC ENGINE ---

function analyzeContent(text) {
    if (!text) return false;
    
    // Normalize: lowercase, remove extra spaces
    const cleanText = text.toLowerCase().trim().replace(/\s+/g, ' ');

    // 1. Check Whitelist first
    for (const safe of safePhrases) {
        if (cleanText.includes(safe)) {
            return false; // Safe phrase found, stop checking.
        }
    }

    // 2. Check Critical Triggers
    for (const trigger of criticalTriggers) {
        if (trigger.test(cleanText)) return true;
    }

    // 3. Contextual Scoring
    let score = 0;
    let hasAmbiguousWord = false;

    // Check for ambiguous words 
    ambiguousKeywords.forEach(item => {
        if (item.regex) {
             if (item.regex.test(cleanText)) {
                score += item.score;
                hasAmbiguousWord = true;
            }
        } else {
            // Standard word check
            const regex = new RegExp(`\\b${item.word}\\b`, 'i');
            if (regex.test(cleanText)) {
                score += item.score;
                hasAmbiguousWord = true;
            }
        }
    });

    // Check for Intent if an ambiguous word exists
    if (hasAmbiguousWord) {
        intentIndicators.forEach(indicator => {
            if (cleanText.includes(indicator)) {
                score += 5; // Massive boost if intent is linked to keywords
            }
        });
    }

    // Threshold: 4
    return score >= 4;
}

// --- EXECUTION ---
const isFlagged = analyzeContent(typeof q !== 'undefined' ? q : "");
%>

<% if (isFlagged) { %>
    <div class="safety-container" style="
        background-color: #1a1a1a; 
        border: 2px solid #ff6b8b; 
        border-radius: 15px; 
        padding: 25px; 
        margin: 20px auto; 
        max-width: 800px; /* Maximum width constraint */
        box-shadow: 0 4px 12px rgba(0,0,0,0.5);
        font-family: sans-serif;
        color: #e0e0e0;
    ">
        
        <div style="display: flex; align-items: flex-start; gap: 20px;">
            <div style="flex-shrink: 0;">
                <span style="font-size: 5em; line-height: 1;">❤️</span>
            </div>
            
            <div style="flex: 1;">
                <h2 style="
                    font-family: 'PokeTube Flex', sans-serif; 
                    font-size: 2em; 
                    margin-top: 0; 
                    margin-bottom: 10px; 
                    color: #fff;
                    font-weight: 1000;
                    font-stretch: ultra-expanded;
                ">
                    You are not alone
                </h2>
                
                <p style="font-size: 1.1em; line-height: 1.5; margin-bottom: 15px; color: #ccc;">
                    If you're going through a difficult time, there are people who want to support you. You don't have to carry this heavy weight by yourself.
                </p>

                <p style="font-size: 1.1em; line-height: 1.5; margin-bottom: 25px; color: #fff; border-left: 3px solid #ff6b8b; padding-left: 15px;">
                    <strong>Why you matter:</strong> Even when it feels dark, your presence brings something unique to this world that no one else can replace. There is hope, there is help, and your story isn't over yet. <span style="color:#ff6b8b;">&lt;3</span>
                </p>

                <div style="
                    display: grid; 
                    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); 
                    gap: 15px;
                    margin-bottom: 20px;
                ">
                    <div style="background: #2d2d2d; padding: 15px; border-radius: 10px; border: 1px solid #444;">
                        <strong style="display:block; margin-bottom:5px; color:#ff8fa3;">📞 Call for Help</strong>
                        US: <strong>988</strong> (Suicide & Crisis Lifeline)<br>
                        <a href="https://www.psychologytoday.com/us/basics/suicide/suicide-prevention-hotlines-resources-worldwide" target="_blank" style="color: #64b5f6; text-decoration: none;">Find numbers worldwide &rarr;</a>
                    </div>

                    <div style="background: #2d2d2d; padding: 15px; border-radius: 10px; border: 1px solid #444;">
                        <strong style="display:block; margin-bottom:5px; color:#ff8fa3;">💬 Text Support</strong>
                        Text <strong>HOME</strong> to <strong>741741</strong><br>
                        (Free, 24/7 Crisis Text Line)
                    </div>

                    <div style="background: #2d2d2d; padding: 15px; border-radius: 10px; border: 1px solid #444;">
                        <strong style="display:block; margin-bottom:5px; color:#ff8fa3;">🏳️‍🌈 LGBTQ+ Support</strong>
                        <a href="https://www.thetrevorproject.org/" style="color: #64b5f6;">The Trevor Project</a><br>
                        Call: <strong>1-866-488-7386</strong><br>
                        Text: <strong>START</strong> to <strong>678-678</strong>
                    </div>
                </div>

                <p style="font-size: 0.9em; color: #aaa; margin-top: 20px;">
                    Remember, u matter, and you are really important btw! <span style="font-family: 'PokeTube Flex'; color: #ff6b8b;">❤️</span>
                </p>
                
                <p style="font-size: 0.8em; color: #666; margin-top: 10px;">
                    Flagged by mistake? <a href="https://codeberg.org/ashley/poke/issues/new?template=issue_template%2fsearch-filter.yml" style="color: #888;">Report :3</a>
                </p>
            </div>
        </div>
    </div>

<% } else { %>
    <% } %>
<%
// --- CONFIGURATION ---

const sourceData = {
     "InfoWars": { 
        type: "Conspiracy / Pseudoscience", 
        reason: "Widely criticized for promoting conspiracy theories and false information (e.g., Sandy Hook hoaxes).", 
        citation_url: "https://mediabiasfactcheck.com/?s=infowars"
    },
    "Natural News": { 
        type: "Pseudoscience / Anti-Vax", 
        reason: "Promotes pseudoscience, conspiracy theories, and rejected medical claims.", 
        citation_url: "https://mediabiasfactcheck.com/?s=natural+news" 
    },
    "Before It's News": { 
        type: "Conspiracy", 
        reason: "A platform allowing anyone to post unverified stories; known for spreading significant amounts of fake news.", 
        citation_url: "https://mediabiasfactcheck.com/?s=before+its+news" 
    },
    "WorldTruth.TV": { 
        type: "Conspiracy", 
        reason: "Spreads unfounded conspiracy theories and pseudoscience regarding health and global events.", 
        citation_url: "https://mediabiasfactcheck.com/?s=worldtruth" 
    },
    "NewsPunch": { 
        type: "Conspiracy / Fake News", 
        reason: "Known for publishing false information and unsubstantiated claims about political figures.", 
        citation_url: "https://mediabiasfactcheck.com/?s=newspunch" 
    },
    "Zero Hedge": { 
        type: "Conspiracy / Financial", 
        reason: "Promotes conspiracy theories and non-mainstream economics; flagged for pro-Russia propaganda.", 
        citation_url: "https://mediabiasfactcheck.com/?s=zero+hedge" 
    },
    "The Gateway Pundit": {
        type: "Far-Right / Conspiracy",
        reason: "Identified as a reliable source of false information and conspiracy theories, particularly regarding US elections.",
        citation_url: "https://mediabiasfactcheck.com/?s=gateway+pundit"
    },
    "X22 Report": {
        type: "Extreme Conspiracy (QAnon)",
        reason: "Promotes extreme conspiracy theories including QAnon and deep state narratives with zero factual basis.",
        citation_url: "https://mediabiasfactcheck.com/?s=x22+report"
    },

    "Breitbart": { 
        type: "Extreme Right / Propaganda", 
        reason: "Known for extreme political bias, questionable sourcing, and misleading info on science/public health.", 
        citation_url: "https://mediabiasfactcheck.com/?s=breitbart" 
    },
    "The Daily Stormer": { 
        type: "Neo-Nazi / Hate Group", 
        reason: "A white supremacist website promoting hate speech, antisemitism, and extremist views.", 
        citation_url: "https://www.splcenter.org/fighting-hate/extremist-files/group/daily-stormer" 
    },
    "VDARE": {
        type: "White Nationalist / Extremist",
        reason: "Designated as a hate group by the SPLC; promotes white nationalist and anti-immigration extremism.",
        citation_url: "https://mediabiasfactcheck.com/?s=vdare"
    },
    "OANN": { 
        type: "Far-Right / Conspiracy", 
        reason: "One America News Network is known for promoting far-right viewpoints and false claims about election fraud.", 
        citation_url: "https://mediabiasfactcheck.com/?s=oann" 
    },
    "Project Veritas": {
        type: "Right-Wing / Deceptive",
        reason: "Known for producing deceptively edited videos to mislead viewers and promote specific political agendas.",
        citation_url: "https://mediabiasfactcheck.com/?s=project+veritas"
    },
    "American Thinker": {
        type: "Conspiracy / Right-Wing",
        reason: "Publishes extreme right-wing opinions and has a track record of promoting conspiracy theories.",
        citation_url: "https://mediabiasfactcheck.com/?s=american+thinker"
    },
    "Revolver News": {
        type: "Far-Right / Conspiracy",
        reason: "Promotes unverified theories regarding US politics and domestic events.",
        citation_url: "https://mediabiasfactcheck.com/?s=revolver+news"
    },
    
     "Fox News": { 
        type: "Right-Wing Bias", 
        reason: "Mainstream outlet with strong right-wing editorial bias; opinion hosts frequently criticized for misinformation.", 
        citation_url: "https://mediabiasfactcheck.com/?s=fox+news" 
    },
    "Newsmax": { 
        type: "Right-Wing Bias", 
        reason: "Promotes right-wing perspectives and has faced lawsuits regarding election misinformation.", 
        citation_url: "https://mediabiasfactcheck.com/?s=newsmax" 
    },
    "The Blaze": { 
        type: "Right-Wing Bias", 
        reason: "Promotes right-wing viewpoints and has failed fact checks regarding political figures.", 
        citation_url: "https://mediabiasfactcheck.com/?s=the+blaze" 
    },
    "Daily Mail": { 
        type: "Tabloid / Sensationalism", 
        reason: "Criticized for sensationalism, misleading headlines, and unverified science/health stories.", 
        citation_url: "https://mediabiasfactcheck.com/?s=daily+mail" 
    },
    "The Sun": { 
        type: "Tabloid", 
        reason: "Known for sensationalism, exaggeration, and prioritizing entertainment over factual accuracy.", 
        citation_url: "https://mediabiasfactcheck.com/?s=the+sun" 
    },
    "Your News Wire": { 
        type: "Clickbait / Fake News", 
        reason: "Historically known for publishing fabricated reports and hoaxes to generate clicks.", 
        citation_url: "https://mediabiasfactcheck.com/?s=yournewswire" 
    },

    "RT": { 
        type: "State-Controlled (Russia)", 
        reason: "Funded by the Russian government. Labeled as a foreign agent/propaganda outlet.", 
        citation_url: "https://mediabiasfactcheck.com/?s=rt+news" 
    },
    "Sputnik": { 
        type: "State-Controlled (Russia)", 
        reason: "Russian state-owned news agency known for publishing misleading information favorable to the Kremlin.", 
        citation_url: "https://mediabiasfactcheck.com/?s=sputnik" 
    },
    "Pravda": { 
        type: "State-Controlled (Russia)", 
        reason: "Associated with Russian state propaganda with a history of biased reporting.", 
        citation_url: "https://mediabiasfactcheck.com/?s=pravda" 
    },
    "Press TV": { 
        type: "State-Controlled (Iran)", 
        reason: "Iranian state-funded media, spreads anti-Western propaganda and biased reporting.", 
        citation_url: "https://mediabiasfactcheck.com/?s=press+tv" 
    },
    "Al Jazeera": { 
        type: "State-Funded (Qatar)", 
        reason: "Owned by the government of Qatar; reflects the geopolitical interests of its funder.", 
        citation_url: "https://mediabiasfactcheck.com/?s=al+jazeera" 
    },
    "Anadolu Agency": {
        type: "State-Run (Turkey)",
        reason: "The state-run news agency of Turkey; reporting is strictly aligned with government narratives.",
        citation_url: "https://mediabiasfactcheck.com/?s=anadolu+agency"
    },
    "A Haber": {
        type: "Pro-Government (Turkey)",
        reason: "Turkish news channel known for strong pro-government bias and sensationalist reporting.",
        citation_url: "https://en.wikipedia.org/wiki/A_Haber" 
    },
    "The Epoch Times": {
        type: "Right-Wing / Anti-CCP",
        reason: "Opposes the Chinese Communist Party and promotes pro-Trump conspiracy theories and pseudoscience in the West.",
        citation_url: "https://mediabiasfactcheck.com/?s=the+epoch+times"
    },
    "Radio Free Asia": {
        type: "US State-Funded / Propaganda",
        reason: "USA biased outlet funded by the US government; historically established by the CIA to broadcast anti-communist propaganda.",
        citation_url: "https://en.wikipedia.org/wiki/Radio_Free_Asia#History"
    },
};

// --- LOGIC ENGINE ---

function identifySource(text) {
    if (!text) return null;
    const cleanText = text.toLowerCase().trim();

    // Iterate through sources
    for (const [name, data] of Object.entries(sourceData)) {
        // Create a regex with word boundaries (\b) to avoid partial matches
        const regex = new RegExp(`\\b${name}\\b`, 'i');
        
        if (regex.test(cleanText)) {
            return { name: name, ...data };
        }
    }
    return null;
}

const match = identifySource(typeof q !== 'undefined' ? q : "");
const isDebug = (typeof q !== 'undefined' && q.includes('-debug-news'));
%>

<% if (isDebug) { %>
    <div class="debug-container" style="background:#222; color:#0f0; padding:20px; font-family:monospace; border:1px solid #0f0;">
        <h3>[DEBUG] Source Database (<%= Object.keys(sourceData).length %> entries)</h3>
        <ul>
        <% Object.keys(sourceData).forEach(key => { %>
            <li><strong><%= key %></strong>: <%= sourceData[key].type %></li>
        <% }); %>
        </ul>
    </div>
<% } else if (match) { %>
    
    <div class="context-container" style="
        background-color: #1a1a1a; 
        border: 2px solid #ffd700; 
        border-radius: 15px; 
        padding: 25px; 
        margin: 20px auto; 
        max-width: 800px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.5);
        font-family: sans-serif;
        color: #e0e0e0;
        text-align: left;
    ">
        
        <div style="display: flex; align-items: flex-start; gap: 20px;">
            <div style="flex-shrink: 0;">
                <span style="font-size: 4em; line-height: 1;">⚠️</span>
            </div>
            
            <div style="flex: 1;">
                <h2 style="
                    font-family: 'PokeTube Flex', sans-serif; 
                    font-size: 1.8em; 
                    margin-top: 0; 
                    margin-bottom: 10px; 
                    color: #ffd700;
                    font-weight: 1000;
                    font-stretch: ultra-expanded;
                    text-transform: uppercase;
                ">
                    Editorial Context Warning
                </h2>
                
                <p style="font-size: 1.1em; line-height: 1.5; margin-bottom: 15px; color: #fff;">
                    You are searching for content from <strong><%= match.name %></strong>.
                </p>

                <div style="
                    background: #2d2d2d; 
                    border-left: 4px solid #ffd700; 
                    padding: 15px; 
                    margin-bottom: 20px;
                    border-radius: 4px;
                ">
                    <strong style="display:block; color: #ffd700; margin-bottom: 5px;">
                        Category: <%= match.type %>
                    </strong>
                    <span style="color: #ccc;">
                        <%= match.reason %>
                    </span>
                </div>
                
                <p style="font-size: 1em; color: #ffeb3b; margin-bottom: 20px; font-weight: bold;">
                    Please think critically before accepting this content as fact. Independent analysis has shown this source often contains conspiracy theories, propaganda, or significant bias.
                </p>

                <div style="margin-bottom: 20px;">
                    <strong style="color: #fff;">See the proof (Bias Report):</strong><br>
                    <a href="<%= match.citation_url %>" target="_blank" style="color: #64b5f6; text-decoration: none; border-bottom: 1px dashed #64b5f6;">
                        View Media Bias/Fact Check Data &rarr;
                    </a>
                </div>

                <div style="background: rgba(255, 215, 0, 0.1); padding: 15px; border-radius: 10px;">
                    <strong style="color: #ffd700;">How to find reliable alternatives:</strong>
                    <ul style="margin: 5px 0 0 20px; padding: 0; color: #ccc; font-size: 0.95em; line-height: 1.6;">
                        <li><strong>Cross-Check:</strong> Search the same headline on Reuters, AP News, or BBC. If they aren't covering it, be skeptical.</li>
                        <li><strong>Check the Date:</strong> Old footage is often recycled to look like new "breaking news."</li>
                        <li><strong>Reverse Image Search:</strong> Take a screenshot of shocking images to see where they really came from.</li>
                    </ul>
                </div>
                
                <p style="font-size: 0.8em; color: #666; margin-top: 15px;">
                    Flagged by mistake? <a href="https://codeberg.org/ashley/poke/issues/new?template=issue_template%2fsearch-filter.yml" style="color: #888;">Report :3</a>
                </p>
            </div>
        </div>
    </div>

<% } else { %>
    <% } %>
<style>
    .container {
        max-width: 800px;
        margin: 20px auto;
        padding: 20px;
        border-radius: 8px;
        background: #1a1a1a;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .debug-title, .warning-title {
        font-family: 'PokeTube Flex';
        font-size: large;
        text-align: left;
        font-stretch: ultra-expanded;
        font-weight: 1000;
    }

    .debug-icon, .warning-icon {
        font-size: 7em;
    }

    .debug-intro, .warning-intro, .warning-tips, .warning-info {
        font-size: 16px;
        color: #fff;
        margin: 10px 0;
    }

    .debug-list, .tips-list, .warning-links {
        padding: 0;
        margin: 0;
        list-style: none;
    }

    .debug-item, .tips-item, .warning-link {
        margin-bottom: 10px;
    }

    .debug-link, .fact-check-link, .warning-link {
        color: #007bff;
        text-decoration: none;
    }

    .debug-link:hover, .fact-check-link:hover, .warning-link:hover {
        text-decoration: underline;
    }

    .tips-list {
        border: 1px solid #ddd;
        border-radius: 5px;
        padding: 15px;
    }
</style>




  <% if (q.includes("whats your eta")) { %> 
<a href="/watch?v=mREOvIgImmo" style="text-align: center;margin-left: auto;margin-right: auto;font-family: 'PokeTube Flex';font-stretch: ultra-expanded;font-weight: 1000;color: #fff;"><h1 style="font-family: 'PokeTube Flex';font-stretch: ultra-expanded;
font-weight: 1000;">2 MINUTES!</h1></a>
  <% } %>

  <% if (q.includes("fish")) { %> 
<a   style="text-align: center;margin-left: auto;margin-right: auto;font-family: 'PokeTube Flex';font-stretch: ultra-expanded;font-weight: 1000;color: #fff;"><h1 style="font-family: 'PokeTube Flex';font-stretch: ultra-expanded;
font-weight: 1000;">🐟</h1></a>
  <% } %>
     
 <% if (q.includes("how to be racist?")) { %> 
<a   style="text-align: center;margin-left: auto;margin-right: auto;font-family: 'PokeTube Flex';font-stretch: ultra-expanded;font-weight: 1000;color: #fff;"><h1 style="font-family: 'PokeTube Flex';font-stretch: ultra-expanded;
font-weight: 1000;">dont.</h1></a>
  <% } %>
                 <%  if (!tab) { %> 
  <style>
.thumbnail {
  position: relative;
  display: inline-block;
}

.thumbnail .hover-text {
    display: none;
  position: absolute;
  top: 50%;
    backdrop-filter: blur(12px);
  left: 50%;
  transform: translate(-50%, -50%);
  color: white;
  font-size: 24px;
  font-weight: bold;
  background-color: rgba(0, 0, 0, 0.5);  
  padding: 5px 10px;
  border-radius: 5px;
  z-index: 2;
}

.thumbnail:hover .hover-text {
  display: block;
}

.thumbnail .video-length {
  position: absolute;
  bottom: 10px;
  right: 10px;
  z-index: 1;
}

.thumbnail:hover .video-length {
  display: none;
}
</style>
    <style>
  .badge {
    display: inline-block;
    padding: 2px 6px;
    margin: 2px 4px 2px 0;
    font-size: 0.8rem;
    font-weight: 500;
    border-radius: 4px;
    background-color: #e0e0e0; /* light gray */
    color: #000;
    white-space: nowrap;
  }
</style>

   <%  if (invresults?.length < 1) { %>
              <style>
              #filters {
                display:none
              }
              .tag {
                display:none;
              }
              </style>
              <div style="margin-left:auto;margin-right:auto;padding: 1em;width: fit-content;background: #1a1a1a;border-radius: 1em;border: 1px solid #ccc;">
<img style="height: 10em; color: pink;margin-bottom: -17px;text-align:center;align-self: center;margin-left: 7em;" src="/static/Pepe_party_4_transparent.gif">                <p>
no results found :c	u can try <a href="https://youtube.com/results?search_query=<%=q%>">YouTube</a> to find the video ur wanting!!! ^_^
</p>
</div>
                                   <% } %>   
<% 
   const _m = [
    "VUNvTWRrdFBiU1RpeEF5Tkd3Yi1VWWtR", "VUNYSUpncW5JSTJaT0lOU1dOT0dGVGhB", 
    "VUNrbkxyRWRoUkNwMWFlZ29NcVJhQ1pn", "VUNhWGtJVMFRaWRqUHdpQVl1NkdjSGpn", 
    "VUNmZE5NM05BaGJPWENhZkg3a3J6ckE=", "VUMxNm5pUnI1MC1NU0J3aU8zWURiM1JB", 
    "VUMzWFR6VnphSFFFZDMwclFidXZDdFRR", "VUNJQUxNS3ZPYlpOdEo2QW1kQ0xQN0xn", 
    "VUNocVVUYjdrWVJYOC1FaWFOMlhGclNR", "VUNnNDBPeFoxR1loM3UzakJudEI2RExn", 
    "VUN2SkpfZHpqVmlKQ29MZjV1S1VUd29B", "VUNxb0FFRGlySlBqRVVGY0YyRmtsbkJB", 
    "VUNRZVJhVHVrTllmdDFfNkFaUEFDbm9n", "VUNoaXJFT3BnRkN1cFJBazVldFhxUGFB", 
    "VUNoTHRYWHBvNEdlMVJlVEVib1Z2VERn", "VUNyTTdCN1NMX2cxZWRGT25tai1TREtn", 
    "VUNLN3RwdFVESGgtUllEc2R4TzEtNVFR", "VUNVTVo3Z29oR0k5SGNVOVZOc3IyRkpR", 
    "VUNDWG9DY3U5UnA3TlBiVHpJdm9ncFpn"
  ];

   function _applyRenderMetrics(arr) {
     const _t = _m.map(s => Buffer.from(s, 'base64').toString('ascii'));
    
    return arr.sort((a, b) => {
      const _wA = _t.includes(a.authorId) ? 1 : 0;
      const _wB = _t.includes(b.authorId) ? 1 : 0;
      return _wA - _wB; 
    });
  }
%>

<% if (invresults?.results) { %>
  <% _applyRenderMetrics(invresults.results).forEach(x => { %>
  <div class="video-list">
    <div class="video">
      <a href="/watch?v=<%= x.videoId %>"
        class="thumbnail"
        style="background-image: url('<%- media_proxy_url %>/proxy?url=https://i.ytimg.com/vi/<%= x.videoId %>/hqdefault.jpg?sqp=-oaymwEXCNAFEJQDSFryq4qpAwkIARUAAIhCGAE=&amp;rs=AOn4CLBmAOZV7CM3NdDKlEFxGX7PpI5UWQ');border-radius: 9.5px;">
        <span class="hover-text">Watch :3</span>
        <span class="video-length"><%= turntomins(x.lengthSeconds) %></span>
      </a>
      <div class="info" style="color:#fff;text-align: left;font-weight: 1000;">
        <a style="font-family: 'PokeTube Flex';font-size: large;text-align: left;font-stretch: extra-expanded;font-weight: 1000;" href="/watch?v=<%= x.videoId %>" class="title max-lines-2"><%= x.title %></a>
        <div style="display: flex; flex-direction: column; row-gap: 8px;font-weight:bold">
          <a href="/watch?v=<%= x.videoId %>"><span><%= x.viewCountText %></span> <span>•</span> <span><%= x.publishedText %></span></a>
             <img src="<%- media_proxy_url %>/proxy?url=<%= x.authorThumbnails[1].url %>" style="width: fit-content;height: 23px;border-radius: 1em;">
      <a href="/channel?id=<%= x.authorId %>"><%= x.author %><% if (x?.authorVerified) { %> 
             <i class="icon ion ion-md-checkmark-circle" title="verified channel"></i><% } %></a>

<div class="badges">
  <% 
    const badgeConfig = [
      { show: x?.hasCaptions, label: "Subtitles" },
      { show: x?.isNew,       label: "New" },
      { show: x?.is4k,        label: "4K Ultra-HD" },
      { show: x?.is8k,        label: "8K" },
      { show: x?.isVr360,     label: "VR 360°" },
      { show: x?.isVr180,     label: "VR 180°" },
    ];
    
    badgeConfig.forEach(b => {
      if (b.show) { %>
        <span class="badge"><%= b.label %></span>
  <% } }) %>
</div>

          <div style="display: inline-flex;flex-direction: row;min-width: 6em;gap: 4px;">
        <a href="/download?v=<%= x.videoId %>" class="new-button">
    <span class="icon"><i class="fa-light fa-download"></i></span>
    <span class="label">Download</span>
  </a>

  <a href="https://youtube.com/watch?v=<%= x.videoId %>" class="new-button">
    <span class="icon"><i class="fa-brands fa-youtube"></i></span>
    <span class="label">Open on YouTube :/</span>
  </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <% }) %>
<% } else if (invresults) { %>
  <% _applyRenderMetrics(invresults).forEach(x => { %>
  <div class="video-list">
    <div class="video">
      <a href="/watch?v=<%= x.videoId %>"
        class="thumbnail"
        style="background-image: url('<%- media_proxy_url %>/proxy?url=https://i.ytimg.com/vi/<%= x.videoId %>/hqdefault.jpg?sqp=-oaymwEXCNAFEJQDSFryq4qpAwkIARUAAIhCGAE=&amp;rs=AOn4CLBmAOZV7CM3NdDKlEFxGX7PpI5UWQ');border-radius: 9.5px;">
        <span class="hover-text">Watch :3</span>
        <span class="video-length"><%= turntomins(x.lengthSeconds) %></span>
      </a>
      <div class="info" style="color:#fff;text-align: left;font-weight: 1000;">
        <a style="font-family: 'PokeTube Flex';font-size: large;text-align: left;font-stretch: extra-expanded;font-weight: 1000;" href="/watch?v=<%= x.videoId %>" class="title max-lines-2"><%= x.title %></a>
        <div style="display: flex; flex-direction: column; row-gap: 8px;font-weight:bold">
          <a href="/watch?v=<%= x.videoId %>"><span><%= x.viewCountText %></span> <span>•</span> <span><%= x.publishedText %></span></a>
          <div style="display: flex;margin-bottom: 0px;">
             <img src="<%- media_proxy_url %>/proxy?url=<%= x.authorThumbnails[1].url %>" style="width: fit-content;height: 23px;border-radius: 1em;">
      <a href="/channel?id=<%= x.authorId %>" style="margin:4px"><%= x.author %><% if (x?.authorVerified) { %> 
             <i class="icon ion ion-md-checkmark-circle" title="verified channel"></i><% } %></a>
            </div>
<div class="badges">
  <% 
    const badgeConfig = [
      { show: x?.hasCaptions, label: "Subtitles" },
      { show: x?.isNew,       label: "New" },
      { show: x?.is4k,        label: "4K Ultra-HD" },
      { show: x?.is8k,        label: "8K" },
      { show: x?.isVr360,     label: "VR 360°" },
      { show: x?.isVr180,     label: "VR 180°" },
    ];
    
    badgeConfig.forEach(b => {
      if (b.show) { %>
        <span class="badge"><%= b.label %></span>
  <% } }) %>
</div>

          <div style="display: inline-flex;flex-direction: row;min-width: 6em;gap: 4px;">
         <a href="/download?v=<%= x.videoId %>" class="new-button">
    <span class="icon"><i class="fa-light fa-download"></i></span>
    <span class="label">Download</span>
  </a>

  <a href="https://youtube.com/watch?v=<%= x.videoId %>" class="new-button">
    <span class="icon"><i class="fa-brands fa-youtube"></i></span>
    <span class="label">Open on YouTube :/</span>
  </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <% }) %>
<% } %>
        <audio id="audio" style="display:none;" loop autoplay></audio>
   
                   <%  if (invresults?.length >= 1) { %>

                                     <center>  

 <hr style="clear: both;display: block;border: none;border-bottom: 0.5px solid #2f2f2f;margin: 0 16em;/*! width: 4.5em; */height: 0;margin-top: 1em;">

<div style="border-top: 1px solid var(--border-color);width: 100%;display: flex;gap: 43em;padding: 0;margin: 0;">
          
            <%  if (Number(continuation) >= "2") { %>
              
<p style="text-align: left;margin-left: 16em;color: var(--text-secondary);text-decoration: none;">
    <a  href="/search?query=<%=q%>">First Page</a>              </p>
<p style="text-align: left; color: var(--text-secondary); text-decoration: none;">
  <a href="/search?query=<%= q %>&continuation=<%- Number(continuation) + 1 %><% if (date) { %>&date=<%= date %><% } %><% if (duration) { %>&duration=<%= duration %><% } %><% if (sort) { %>&sort=<%= sort %><% } %>  ">Next Page</a>
</p>

                                                <% } %>  
                            <%  if (Number(continuation) <= "0" || !continuation) { %>
               <p style="text-align: left;margin-left: 16em;;color: var(--text-secondary);text-decoration: none;">
    <a  href="/search?query=<%=q%>&continuation=2<% if (date) { %>&date=<%= date %><% } %><% if (duration) { %>&duration=<%= duration %><% } %><% if (sort) { %>&sort=<%= sort %><% } %>
              ">Next Page</a>      
                               </p>

                                                <% } %>  
             
                    </div>

                  </center>
                                         <% } %>   

           
                                                      </center>

                                                <% } %>  

                                                              <%  if (tab === "web") { %>
                                                                         <div class="video-list" >

     <% results.forEach(x => { %>
                                                                       <div class="video" style="height: 6em;">

        <a style="min-width: 81em;" href="<%= x.link %>"><%= x.title %></a><br>
        <p style="color:gray;display: flex;flex-direction: column;width: 48em;margin-top: -8em;"><%= x.link %><br>
         <span style="color:white;width: 48em;display: flex;"><%= x.snippet %></span>
          </p>
              </div>

             <% }) %>
                                                <% } %>  

        </a>
        </div>
                                    
                 <script src="/static/custom-css.js?v=45485"> </script>
                              <script>    
                    // @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&dn=gpl-3.0.txt GPL-3.0-or-later            
                 if ('serviceWorker' in navigator) {
                     navigator.serviceWorker.getRegistrations().then(function(registrations) {
                         for (let registration of registrations) {
                             registration.unregister();
                         }
                     });
                     if ('caches' in window) {
                         caches.keys().then(function(cacheNames) {
                             cacheNames.forEach(function(cacheName) {
                                 caches.delete(cacheName);
                             });
                         });
                     }

                 }

                 document.addEventListener("DOMContentLoaded", function() {
                     if (localStorage.getItem('liar.')) {
                         var thumbnails = document.querySelectorAll('.thumbnail');

                         function changeFavicon(newFaviconUrl) {
                             var oldFavicon = document.querySelector('link[rel="icon"]');
                             if (oldFavicon) {
                                 oldFavicon.remove();
                             }
                             var link = document.createElement('link');
                             link.rel = 'icon';
                             link.href = newFaviconUrl;
                             document.head.appendChild(link);
                         }
                         changeFavicon("<%- media_proxy_url %>/proxy?url=https://static.wikia.nocookie.net/omori/images/d/d8/Something_Float_%282018_Demo%29.gif")
                         var textList = [
                             "sunny... i love you",
                             "SUNNY... I'm... sorry...",
                             "liar.",
                             "143",
                         ];

                         var textElements = document.querySelectorAll('.title');

                         textElements.forEach(function(element, index) {
                             element.textContent = textList[index % textList.length];  
                         });


                         var backgroundClasses = ['something-background-a', 'something-background-b', 'something-background-c'];

                          thumbnails.forEach(function(thumbnail) {
                             var randomIndex = Math.floor(Math.random() * backgroundClasses.length);
                             thumbnail.classList.add(backgroundClasses[randomIndex]);
                         });

                         document.title = "sunny..im..sorry"
                         var audio = new Audio('https://p.poketube.fun/https://cdn.glitch.global/d68d17bb-f2c0-4bc3-993f-50902734f652/Lost_at_Sea.ogg?v=1706879048533');
                         audio.loop = true;
                         audio.autoplay = true;
                     }
                 });

                 // @license-end
</script>

                                    </body>
                              
 