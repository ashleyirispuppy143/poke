<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>PokeTube | Customize</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <link href="/css/yt-ukraine.svg?v=6" rel="icon">
  
  <link rel="stylesheet" href="https://p.poketube.fun/https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
  <link rel="stylesheet" href="https://p.poketube.fun/https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css">
  <link rel="stylesheet" href="https://p.poketube.fun/https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/scroll/simplescrollbars.min.css">

  <style>
    @import url("https://p.poketube.fun/https://site-assets.fontawesome.com/releases/v6.1.1/css/all.css");

     @font-face {
      src: url("/css/OpenDyslexic3-Regular.ttf");
      font-family: "OpenDyslexic3";
      font-style: normal;
      font-stretch: 1% 800%;
      font-display: swap;
    }

    @font-face {
      font-family: "PokeTube Flex";
      src: url("/static/robotoflex.ttf");
      font-style: normal;
      font-stretch: 1% 800%;
      font-display: swap;
    }

    :root {
      --bg: #0b0b0b; 
      --surface: #141414; 
      --surface-border: #2a2a2a;
      --text: #f3f3f3; 
      --muted: #a1a1a1;
      --accent: #ffabcc; 
      --accent-hover: #ff8cb6;
      --accent-glow: rgba(255, 171, 204, 0.4);
      --font-main: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif;
      --font-mono: 'JetBrains Mono', 'Fira Code', ui-monospace, SFMono-Regular, Consolas, monospace;
    }

    * { box-sizing: border-box; outline: none; }
    
    body {
      margin: 0; padding: 0; color: var(--text); font-family: var(--font-main);
      background: var(--bg); overflow-x: hidden; min-height: 100vh;
    }

    a { color: var(--accent); text-decoration: none; transition: color 0.2s; }
    a:hover { color: var(--accent-hover); text-decoration: underline; }

    /* Navbar */
    .navbar {
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 24px; height: 70px;
      position: sticky; top: 0; z-index: 100;
      backdrop-filter: blur(16px) saturate(180%);
      background: rgba(11, 11, 11, 0.8);
      border-bottom: 1px solid rgba(255, 171, 204, 0.1);
    }
    .navbar__logo { height: 28px; display: block; filter: drop-shadow(0 0 8px rgba(0,0,0,0.5)); }
    
    .navbar__search {
      flex: 1; max-width: 500px; margin: 0 20px; position: relative;
    }
    .search-input {
      width: 100%; background: rgba(255,255,255,0.05);
      border: 1px solid var(--surface-border); border-radius: 99px;
      padding: 10px 45px 10px 20px; color: #fff; transition: 0.2s;
    }
    .search-input:focus { background: rgba(0,0,0,0.4); border-color: var(--accent); box-shadow: 0 0 0 3px rgba(255,171,204,0.15); }
    .search-btn {
      position: absolute; right: 5px; top: 50%; transform: translateY(-50%);
      background: none; border: none; color: var(--muted); cursor: pointer; padding: 8px;
    }

    .navbar__actions { display: flex; gap: 12px; }
    .nav-icon {
      width: 40px; height: 40px; border-radius: 12px;
      display: grid; place-items: center; color: var(--text);
      background: rgba(255,255,255,0.03); border: 1px solid var(--surface-border);
      text-decoration: none; transition: 0.2s;
    }
    .nav-icon:hover { background: rgba(255,255,255,0.1); color: var(--accent); }

    /* Hero Branding Area */
    .hero-branding {
      position: relative;
      background: linear-gradient(135deg, #a83258 0%, #ffabbc 80%);
      padding: 100px 20px 160px;
      text-align: center;
      overflow: hidden;
      border-bottom: 1px solid rgba(255, 171, 188, 0.2);
    }

    /* Background Text Container */
    .hype-container {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%) rotate(-8deg);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 35px;
      z-index: 0;
      pointer-events: none;
      width: 150%;
      height: 90%;
    }

    .hype-text {
      font-size: clamp(35px, 5vw, 75px);
      font-family: "PokeTube Flex", sans-serif;
      font-weight: 1000;
      color: #fff;
      white-space: nowrap;
      letter-spacing: 3px;
      text-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    
    .hype-text:nth-child(odd) { opacity: 0.12; margin-left: -5%; }
    .hype-text:nth-child(even) { opacity: 0.08; margin-left: 5%; }

    /* Mascot */
    .mascot {
      position: absolute;
      bottom: 0; 
      right: 10%;
      max-height: 280px;
      object-fit: contain;
      z-index: 2;
      filter: drop-shadow(0 -10px 20px rgba(0,0,0,0.4));
      pointer-events: none;
    }

    /* Hero Content */
    .hero-content {
      position: relative;
      z-index: 3;
      max-width: 800px;
      margin: 0 auto;
      text-align: center;
    }

    .doc-title {
      font-family: "PokeTube Flex", sans-serif;
      font-size: clamp(45px, 8vw, 100px);
      font-weight: 1000;
      font-stretch: extra-expanded;
      color: #fff;
      margin: 0 0 16px 0;
      line-height: 1.05;
      letter-spacing: -0.02em;
      text-shadow: 0 8px 25px rgba(0,0,0,0.5);
    }

    .doc-lede { 
      font-size: 1.2rem; 
      color: #fff; 
      text-shadow: 0 4px 12px rgba(0,0,0,0.6); 
      margin: 0 auto; 
      max-width: 600px; 
      font-weight: 500;
    }

    /* Main Container */
    .container { 
      max-width: 1300px; 
      margin: -80px auto 60px; 
      padding: 0 20px; 
      position: relative;
      z-index: 10;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Modern Tabs */
    .tabs-wrapper {
      background: rgba(15, 15, 15, 0.8);
      backdrop-filter: blur(12px);
      padding: 6px;
      border-radius: 100px;
      border: 1px solid var(--surface-border);
      display: inline-flex;
      margin-bottom: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }
    
    .tab {
      padding: 10px 32px; 
      border-radius: 100px; 
      color: var(--muted);
      text-decoration: none; 
      font-size: 15px; 
      font-weight: 700;
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .tab i { font-size: 16px; }
    .tab:hover { color: #fff; text-decoration: none; }
    .tab.active { 
      background: var(--accent); 
      color: #000; 
      box-shadow: 0 4px 15px var(--accent-glow); 
    }

    /* New Improved Editor Panel */
    .editor-card {
      background: #0a0a0a; 
      border: 1px solid #222;
      border-radius: 20px; 
      overflow: hidden;
      box-shadow: 0 25px 60px rgba(0,0,0,0.7), 0 0 0 1px rgba(255, 171, 204, 0.1);
      display: flex; 
      flex-direction: column; 
      height: 65vh;
      width: 100%;
    }

    .editor-toolbar {
      padding: 14px 24px; 
      background: #111;
      border-bottom: 1px solid #222;
      display: flex; 
      justify-content: space-between; 
      align-items: center;
    }
    
    .editor-info { 
      font-size: 14px; 
      color: var(--text); 
      display: flex; 
      gap: 12px; 
      align-items: center; 
      font-weight: 600;
    }
    
    .editor-info i { color: var(--accent); font-size: 18px; }
    .badge { 
      background: rgba(255,255,255,0.08); 
      padding: 4px 10px; 
      border-radius: 6px; 
      font-family: var(--font-mono); 
      font-size: 12px; 
      font-weight: normal;
      color: var(--muted);
    }

    .btn-group { display: flex; gap: 10px; }
    
    .btn {
      border: 1px solid #333; 
      background: #1a1a1a;
      color: #fff; 
      padding: 8px 16px; 
      border-radius: 8px;
      font-size: 13px; 
      font-weight: 600;
      cursor: pointer; 
      transition: all 0.2s; 
      display: flex; 
      align-items: center; 
      gap: 8px;
    }
    .btn i { font-size: 14px; }
    .btn:hover { background: #2a2a2a; border-color: #444; }
    
    .btn.primary { 
      background: var(--accent); 
      color: #000; 
      border-color: transparent; 
      box-shadow: 0 2px 10px var(--accent-glow);
    }
    .btn.primary:hover { 
      background: var(--accent-hover); 
      transform: translateY(-1px);
    }
    
    .btn.danger { color: #ff6b6b; border-color: rgba(255,107,107,0.3); }
    .btn.danger:hover { background: rgba(255,107,107,0.1); }

    /* CodeMirror Overrides */
    .CodeMirror {
      flex: 1; 
      height: auto !important;
      font-family: var(--font-mono) !important; 
      font-size: 15px;
      line-height: 1.6;
      background: transparent !important;
      padding: 10px 0;
    }
    .cm-s-dracula.CodeMirror { background: #0a0a0a !important; }
    .CodeMirror-gutters { 
      background: #0f0f0f !important; 
      border-right: 1px solid #222 !important; 
      padding-right: 5px;
    }
    .CodeMirror-linenumber { color: #555 !important; }
    .CodeMirror-cursor { border-left: 2px solid var(--accent) !important; }
    .CodeMirror-selected { background: rgba(255, 171, 204, 0.2) !important; }

    /* Toast Notification */
    .toast-container {
      position: fixed; bottom: 30px; right: 30px; z-index: 2000;
      display: flex; flex-direction: column; gap: 10px;
    }
    .toast {
      background: #111; color: #fff; padding: 14px 24px;
      border-radius: 12px; border: 1px solid rgba(255, 171, 204, 0.3);
      box-shadow: 0 10px 30px rgba(0,0,0,0.6);
      font-size: 14px; font-weight: 500; display: flex; align-items: center; gap: 12px;
      animation: slideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .toast i { color: var(--accent); font-size: 18px; }
    @keyframes slideIn { 
      from { transform: translateY(30px) scale(0.95); opacity: 0; } 
      to { transform: translateY(0) scale(1); opacity: 1; } 
    }

    @media (max-width: 800px) {
      .hero-branding { padding: 80px 20px 120px; }
      .doc-title { font-size: clamp(38px, 10vw, 60px); }
      .mascot { max-height: 180px; right: -10px; }
      .container { margin-top: -40px; }
      .editor-toolbar { flex-direction: column; gap: 16px; align-items: flex-start; }
      .btn-group { width: 100%; flex-wrap: wrap; }
      .btn { flex: 1; justify-content: center; }
    }
  </style>
</head>
<body>

  <nav class="navbar">
    <div class="navbar__left">
      <a href="/"><img class="navbar__logo" src="/css/logo-poke.svg?v=5" alt="PokeTube"></a>
    </div>
    <form class="navbar__search" action="/search">
      <input name="query" class="search-input" type="search" placeholder="Search videos, channelsâ€¦" />
      <button class="search-btn" type="submit"><i class="fa-light fa-search"></i></button>
    </form>
    <div class="navbar__actions">
      <a class="nav-icon" href="/domains" title="Domains"><i class="fa-light fa-server"></i></a>
      <a class="nav-icon" href="/policies/privacy" title="Privacy"><i class="fa-light fa-shield"></i></a>
      <a class="nav-icon" href="/video/upload" title="Upload"><i class="fa-light fa-video"></i></a>
    </div>
  </nav>

  <section class="hero-branding">
    <div class="hype-container">
      <div class="hype-text">YOUR PRIVACY APP OF YOUR DREAMS</div>
      <div class="hype-text">YOUR PRIVACY APP OF YOUR DREAMS</div>
      <div class="hype-text">YOUR PRIVACY APP OF YOUR DREAMS</div>
      <div class="hype-text">YOUR PRIVACY APP OF YOUR DREAMS</div>
      <div class="hype-text">YOUR PRIVACY APP OF YOUR DREAMS</div>
      <div class="hype-text">YOUR PRIVACY APP OF YOUR DREAMS</div>
      <div class="hype-text">YOUR PRIVACY APP OF YOUR DREAMS</div>
    </div>
    
     
    <div class="hero-content">
      <h1 class="doc-title">Customize Poke</h1>
      <p class="doc-lede">Theme your experience with custom scripts and styles. Go wild!</p>
    </div>
  </section>

  <div class="container">
    
    <div class="tabs-wrapper">
      <% if (!tab) { %>
        <a class="tab active" href="/customize"><i class="fa-brands fa-css3"></i> Styles</a>
        <a class="tab" href="/customize?tab=js"><i class="fa-brands fa-js"></i> Scripts</a>
      <% } else { %>
        <a class="tab" href="/customize"><i class="fa-brands fa-css3"></i> Styles</a>
        <a class="tab active" href="/customize?tab=js"><i class="fa-brands fa-js"></i> Scripts</a>
      <% } %>
    </div>

    <% if (!tab) { %>
    <div class="editor-card">
      <div class="editor-toolbar">
        <div class="editor-info">
          <i class="fa-brands fa-css3-alt"></i>
          <span>Global CSS</span>
          <span class="badge">localStorage['poke-custom-css']</span>
        </div>
        <div class="btn-group">
          <button class="btn primary" onclick="saveEditor('css')"><i class="fa-solid fa-floppy-disk"></i> Save</button>
          <button class="btn" onclick="copyEditor('css')"><i class="fa-regular fa-copy"></i> Copy</button>
          <button class="btn" onclick="downloadEditor('css')"><i class="fa-solid fa-download"></i> Export</button>
          <button class="btn danger" onclick="resetEditor('css')"><i class="fa-solid fa-trash-can"></i> Reset</button>
        </div>
      </div>
      <textarea id="css-area"></textarea>
    </div>
    <% } %>

    <% if (tab) { %>
    <div class="editor-card">
      <div class="editor-toolbar">
        <div class="editor-info">
          <i class="fa-brands fa-js"></i>
          <span>Global Script</span>
          <span class="badge">localStorage['poke-custom-script']</span>
        </div>
        <div class="btn-group">
          <button class="btn primary" onclick="saveEditor('js')"><i class="fa-solid fa-floppy-disk"></i> Save</button>
          <button class="btn" onclick="copyEditor('js')"><i class="fa-regular fa-copy"></i> Copy</button>
          <button class="btn" onclick="downloadEditor('js')"><i class="fa-solid fa-download"></i> Export</button>
          <button class="btn danger" onclick="resetEditor('js')"><i class="fa-solid fa-trash-can"></i> Reset</button>
        </div>
      </div>
      <textarea id="js-area"></textarea>
    </div>
    <% } %>
  </div>

  <div class="toast-container" id="toaster"></div>

  <script src="https://p.poketube.fun/https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
  <script src="https://p.poketube.fun/https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/css/css.min.js"></script>
  <script src="https://p.poketube.fun/https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
  <script src="https://p.poketube.fun/https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/closebrackets.min.js"></script>

  <script>
     const CONFIG = {
      css: { key: 'poke-custom-css', mode: 'css', default: '/* \n  PokeTube Custom CSS\n  Go wild! \n*/\n\nbody {\n  \n}' },
      js:  { key: 'poke-custom-script', mode: 'javascript', default: '/* \n PokeTube Custom Script\n Go wild! \n*/\n\nconsole.log("PokeTube Loaded");' }
    };

    let editorInstance = null;

    document.addEventListener('DOMContentLoaded', () => {
      <% if (!tab) { %> initEditor('css'); <% } %>
      <% if (tab) { %> initEditor('js'); <% } %>
    });

    function initEditor(type) {
      const textarea = document.getElementById(type + '-area');
      const savedContent = localStorage.getItem(CONFIG[type].key) || CONFIG[type].default;
      
      textarea.value = savedContent;

      editorInstance = CodeMirror.fromTextArea(textarea, {
        mode: CONFIG[type].mode,
        theme: 'dracula',
        lineNumbers: true,
        autoCloseBrackets: true,
        tabSize: 2,
        lineWrapping: true,
        extraKeys: {"Ctrl-Space": "autocomplete"}
      });

      /* Live CSS Preview */
      if (type === 'css') {
        const previewStyle = document.createElement('style');
        previewStyle.id = 'live-preview-style';
        document.body.appendChild(previewStyle);
        
        /* Initial load */
        previewStyle.textContent = savedContent;

        editorInstance.on('change', () => {
          previewStyle.textContent = editorInstance.getValue();
        });
      }
    }

    /* ACTIONS */

    function saveEditor(type) {
      const content = editorInstance.getValue();
      localStorage.setItem(CONFIG[type].key, content);
      showToast('success', 'Settings Saved Successfully');
    }

    function resetEditor(type) {
      if(confirm('Are you sure you want to reset code? This cannot be undone.')) {
        editorInstance.setValue(CONFIG[type].default);
        saveEditor(type); /* Save the reset state */
        showToast('warn', 'Editor Reset to Default');
      }
    }

    function copyEditor(type) {
      const content = editorInstance.getValue();
      navigator.clipboard.writeText(content).then(() => {
        showToast('info', 'Code Copied to Clipboard');
      });
    }

    function downloadEditor(type) {
      const content = editorInstance.getValue();
      const ext = type === 'css' ? 'css' : 'js';
      const blob = new Blob([content], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `poke-custom.${ext}`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      showToast('info', 'Download Started');
    }

 
    function showToast(type, msg) {
      const container = document.getElementById('toaster');
      const el = document.createElement('div');
      el.className = 'toast';
      
      let icon = 'fa-check-circle';
      if(type === 'warn') icon = 'fa-triangle-exclamation';
      if(type === 'info') icon = 'fa-circle-info';

      el.innerHTML = `<i class="fa-solid ${icon}"></i> <span>${msg}</span>`;
      container.appendChild(el);

      setTimeout(() => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(30px) scale(0.95)';
        setTimeout(() => el.remove(), 400);
      }, 3000);
    }
  </script>
</body>
</html>